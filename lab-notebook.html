<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#"> <!-- namespaces used in metadata.html -->
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
  <title>Lab Notebook</title>
  <meta name="author" content="Carl Boettiger" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  

<!-- Get date last modified from git log. (Uses current time if file entry not found, e.g. projects/)  -->



<!-- For posts, page.date is the date they are published under, which we use as their 'canonical' dc:date -->
 <!-- If we don't have a page.date, then use modified time (pages) -->
   


<!-- Posts declare modified timestamps in the sidebar, so would be redundant to put here. But then 
     pages don't have a dc:modified... unless we give them their own (modified) sidebar?  
-->
<!-- Ideally we would want date originally created from the _oldest_ git commit too...-->

<!-- HTML5 metadata -->
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="resource_type" content="website"/> 
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Lab Notebook" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2013-07-31T22:00:31-07:00" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/lab-notebook.html" />
<meta property="dc:rights" content="CC0" />
<meta property="dc:source" content="Lab Notebook" />
<meta property="dc:subject" content="Ecology" /> 
<meta property="dc:type" content="website" /> 
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Lab Notebook" />
<meta property="og:author" content="http://carlboettiger.info/index.html#me" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2013-07-31T22:00:31-07:00" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://carlboettiger.info/lab-notebook.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_date" content="2013-07-31T22:00:31-07:00"/>
<meta name="citation_title" content="Lab Notebook"/>
<meta name="citation_journal_title" content="Lab Notebook"/>

<!--NOTE: see also the COinS Metadata in span element in footer -->




  <!-- CSS Stylesheets (alternate sheets toggled with javascript or browsers supporting rel='alternative stylesheet') -->
  <link href="/assets/css/bootstrap.css" rel="stylesheet" 
        type="text/css" title="white" />
  <link href="/assets/css/light.css" rel="alternate stylesheet"
        type="text/css" id="stl" title="light" />
  <link href="/assets/css/dark.css" rel="alternate stylesheet" 
        type="text/css" title="dark" />
  <link href="/assets/css/bootstrap-responsive.css" rel="stylesheet" 
  type="text/css"/>
  <!-- Help the browser identify the RSS feed automatically -->
  <link rel="alternate" type="application/rss+xml" title="Carl Boettiger's Lab Notebook" href="/blog.xml" />
  <!-- Javascript needed for theme toggle, load immediately -->
  <script type="text/javascript" src="/assets/js/switch-css.js"></script>
  <script type="text/javascript">set_style_from_cookie(); </script>
</head>


  <body prefix="dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/"> 
    <!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html"><i style="float:right;" class="icon-info-sign" alt="info"></i></span></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/vita.html">Vita</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/teaching.html">Teaching</a></li>

          <li>
          <a href="/community.html">Community</a></li>

          <li class="active">
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>
      </div><!--/.nav-collapse -->

      <!-- Search site using Google's index -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
        <p>
          <input type="hidden" name="q" value="site:carlboettiger.info" />
          <input type="text" class="search-query" name="q" />
          <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
        </p>
      </form>
      <!--
      <div id="search">
      <form method="get" class="navbar-search pull-right form-search">
        <p>
        <input type="text" name="search-text" id="search-text">
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
        </p>
      </form>
      </div>
      -->
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->



    <div class="container"> <!-- Responsive grid layout --> 

      <header class="jumbotron">
  <h1 class="entry-title">Lab Notebook</h1>
  <h3>(<a href="http://www.carlboettiger.info/2012/09/28/Welcome-to-my-lab-notebook.html">Introduction</a>)</h3>
</header>



<div class="row feed">
  <div class="span3 offset1">
    <h4>  <a property="account" href="https://github.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><i class="icon-github" alt="github"></i> Coding </a></h4> 
    <div class="excerpt">
      <div class="scroll">
        <ul><li>cboettig pushed to master at cboettig/labnotebook: <em>minor update to open science / interviews section reformat service section, number presentations update a few references and links</em> <a href="https://github.com/cboettig/labnotebook/compare/cc5d82746d...86ddf20dbb">09:59 2013/10/18</a></li><li>cboettig commented on issue ropensci/RNeXML#24: <em>@hlapp Thanks. It's a treat to be able to draw on your expertise as I try to wrap my head around semantics better. conceptual Yeah, I realize ncbi:id</em> <a href="https://github.com/ropensci/RNeXML/issues/24#issuecomment-26611912">04:57 2013/10/18</a></li><li>cboettig commented on commit ropensci/RNeXML@bf991b2f03: <em>Yeah, warning msg just needs to be more informative, an example or even an a link to an exexample would be nice...</em> <a href="https://github.com/ropensci/RNeXML/commit/bf991b2f0348a5262c081c504776c7bf169252e2#-P0">01:44 2013/10/18</a></li><li>cboettig pushed to master at ropensci/RNeXML: <em>toTaxon added as rel for ResourceMeta in taxize fix taxize to warn when no ID can be found handle namespaces explicitly, allowing for alternate definit</em> <a href="https://github.com/ropensci/RNeXML/compare/e648ac4581...05eaecf1e8">11:52 2013/10/17</a></li><li>cboettig pushed to master at ropensci/rcrossref: <em>added bibentry parser following hadley's advice</em> <a href="https://github.com/ropensci/rcrossref/compare/906c36b592...50acc2e854">11:48 2013/10/17</a></li></ul>
      </div>
    </div>
  </div>
  <div class="span3">
    <h4> <a property="account" href="https://twitter.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); return false;"><i class="icon-twitter"></i> Discussing </a></h4> 
     <div class="excerpt">
      <div class="scroll">
       <ul><li><p>@hadleywickham @recology_ thanks. yeah, no need for extension mechanism, easier to wrap in custom parser anywho</p>
 <a href="http://twitter.com/cboettig/statuses/390987973073719297">04:49 2013/10/17</a> </li><li><p>@hadleywickham &#39;Details&#39; in content documentation says I should.  Adding a bibtex parser to convert to bibentry. <a href="https://t.co/MZu5QRXvZi">https://t.co/MZu5QRXvZi</a></p>
 <a href="http://twitter.com/cboettig/statuses/390958667614265344">02:53 2013/10/17</a> </li><li><p>@hadleywickham how do I add a custom parser function to httr:::parsers?</p>
 <a href="http://twitter.com/cboettig/statuses/390884672340631552">09:59 2013/10/17</a> </li><li><p>Nice paper by @landismj et al now out in @systbiol for a phylogeography method that truly scales... <a href="http://t.co/rSLIrEldhy">http://t.co/rSLIrEldhy</a></p>
 <a href="http://twitter.com/cboettig/statuses/390572395150704640">01:18 2013/10/16</a> </li><li><p>@Github announces launch of <a href="http://t.co/cY85X3JG0p">http://t.co/cY85X3JG0p</a> as it continues to take over the world / make it a better… <a href="http://t.co/60OLNyFU6w">http://t.co/60OLNyFU6w</a></p>
 <a href="http://twitter.com/cboettig/statuses/390568442274668545">01:02 2013/10/16</a> </li></ul>
      </div>
    </div> 
  </div> 
  <div class="span3">
    <h4> <a href="http://www.mendeley.com/groups/634301/theoretical-ecology/papers/" onClick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); return false;"><i class="icon-book"></i> Reading </a></h4> 
    <div class="excerpt">
      <div class="scroll">
      <ul>
<li>Alan Hastings. 2013. Temporal scales of resource variability: Effects on population dynamics of structured populations <em>Ecological Complexity</em> <strong></strong>  <a href="http://dx.doi.org/10.1016/j.ecocom.2013.08.003">10.1016/j.ecocom.2013.08.003</a> </li>
<li>Andrew M. Kramer, M. Maille Lyons, Fred C. Dobbs et al. 2013. Bacterial colonization and extinction on marine aggregates: stochastic model of species presence and abundance <em>Ecology and Evolution</em> <strong></strong>  <a href="http://dx.doi.org/10.1002/ece3.789">10.1002/ece3.789</a> </li>
<li>Matthew R Evans, Mike Bithell, Stephen J Cornell et al. 2013. Predictive systems ecology. <em>Proceedings. Biological sciences / The Royal Society</em> <strong>280</strong> 1771 <a href="http://dx.doi.org/10.1098/rspb.2013.1452">10.1098/rspb.2013.1452</a> </li>
<li>Pete C Trimmer. 2013. Optimal behaviour can violate the principle of regularity. <em>Proceedings. Biological sciences / The Royal Society</em> <strong>280</strong> 1763 <a href="http://dx.doi.org/10.1098/rspb.2013.0858">10.1098/rspb.2013.0858</a> </li>
<li>Jonas Knape, Perry de Valpine. 2012. Are patterns of density dependence in the Global Population Dynamics Database driven by uncertainty about population abundance? <em>Ecology letters</em> <strong>15</strong> 1 <a href="http://dx.doi.org/10.1111/j.1461-0248.2011.01702.x">10.1111/j.1461-0248.2011.01702.x</a> </li>

      </div>
    </div>
  </div> 
</div>

<hr>
<div class="row postpreview">
  <div class="span11 offset1">
    <div class="row">
      <h4> <a href="http://carlboettiger.info/atom.xml"
              onClick="recordOutboundLink(this,
              'Outbound Links', 'RSS'); return false;"
              style="color: inherit;"
              ><i class="icon-rss" ></i> Entries</a></h4>
      
        <div class="span3">
          <header><h4><a href="/2013/10/10/notes.html">Notes</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 10 Oct 2013</p>

<p style="font-style:italic"> pageviews: 9 </p>

<article>
<div class="excerpt">
<h3 id="authenticating-via-dataone-api">Authenticating via DataOne API</h3>
<p>Matt Jones provides a nice <code>dataone</code> package to handle accessing and posting data to DataOne nodes such as the KNB from R. Uploading files through the API requires authentication, which in turn requires a certificate from CILogin. As this process proved a bit tricky to me, I add some documentation here. I am using a Ubuntu (13.04) system, so the procedure might differ slightly for other systems.</p>
<ol type="1">
<li><p>Go to <a href="https://cilogon.org/?skin=DataONE">https://cilogon.org/?skin=DataONE</a></p></li>
<li><p>Select authentication credentials. I used Google as an OpenID provider.</p></li>
<li><p>This asked me to download a file named <code>shibCILaunchGSCA.jnlp</code>. This is a java webstart application and is suppsed to launch in the browser; a feature many operating systems apparently disabled due to security concerns. One could reconfigure the browser settings to execute this file type (using javaws), or simply download and run javaws manually in the command line:</p></li>
</ol>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">javaws</span> shibCILaunchGSCA.jnlp</code></pre>
<p>My process was slightly more troublesome as I had <code>java-6-openjdk</code> <code>javaws</code> installed as the default but needed the <code>java-7</code> one to correspond to the rest of my setup… Also more complicated in that I downloaded <code>shibCILaunchGSCA.jnlp</code> twice and first tried <code>javaws</code> on the earlier download, which had become invalid when I created the second download. Words to the wise…</p>
<p>This should basically finish the authentication by installing a certificate in <code>/tmp/x509up_u0</code>, where the R package will look for it. If you already have a file of that name in <code>/tmp</code> it will use a different name and the R package may be confused. You can work around this (see <a href="https://github.com/mbjones/opensci_r_esa_2013/issues/3#issuecomment-25998107">#3</a>) but better to use the default for simplicity.</p>
<p>At this point we can successfully upload data to DataOne nodes such as the KNB as illustrated in <a href="https://github.com/mbjones/opensci_r_esa_2013/blob/ea8d106f912319bdcf7c1b54e33904a19954434f/dataone-r/dataone-write-data.R">Matt’s tutorial</a>.</p>
<h4 id="notes">Notes</h4>
<p>This presupposes a working <code>rJava</code> package, which can be tricky on Linux systems given the plethora of different flavors of Java. Though <code>rJava</code> is provided as a Ubuntu binary (<code>apt-get install r-cran-rjava</code>) the version is rather behind. Stackoverflow has some useful hints.</p>
<h4 id="todo">ToDo</h4>
<ul>
<li>Should now be able to wrap the dataone API in <code>reml</code> in a similar way as we have done for figshare.<br /></li>
<li>Might consider implementing the REST-based DataONE API calls directly through <code>RCurl</code> or <code>httr</code> to avoid the java issues. Will need to handle the certificate issues above regardless, though some steps can perhaps be wrapped into an R function…</li>
</ul>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/10/10/notes.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/10/07/nexml-phylo-class-extension.html">Extending ape::phylo class to NeXML:</a></h4></header>
<p><span>Promoting an S3 class into S4 while maintaining existing methods</span></p>
<p style="font-style:italic"> 07 Oct 2013</p>

<p style="font-style:italic"> pageviews: 26 </p>

<article>
<div class="excerpt">
<p>While working on the <a href="https://github.com/ropensci/RNeXML">RNeXML</a> package, I have recently I have been puzzling over extending S3 objects to share some of the nice properties of S4 objects and methods while continuing to function with the potentially huge library of functions written to work with them. <a href="http://stackoverflow.com/questions/17976217/make-s4-object-act-as-an-s3-class">SO:</a></p>
<p>To illustrate this issue, consider the S3 class <code>phylo</code> provided by the <code>ape</code> package and used by most of the 30+ packages that reverse depend or reverse import <code>ape</code>. Despite this popularity, the S3 class has quite a few shortcomings (including inconsistent definition in ordering of it’s components, see the phylobase paper). To address these concerns, a hackathon consisting of many of the leading developers in this field created the <code>phylobase</code> package with <code>S4</code> definitions of <code>phylo</code> objects that extend the class to handle additional types of data and address various other concerns that have arisen. Unfortunately, as far as I can tell, adoption of the new format has been lacking. In my mind, the greatest limitation of the new format is the lack of compatibility with existing methods build on the S3 type.</p>
<p>I never understood why phylobase did not do this. To illustrate the problem, let us load an S3 <code>phylo</code> object and then coerce it into the <code>phylobase</code> S4 type:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(phylobase)
<span class="kw">library</span>(ape)
<span class="kw">data</span>(bird.orders)
bird.orders4 &lt;-<span class="st"> </span><span class="kw">as</span>(bird.orders, <span class="st">&quot;phylo4&quot;</span>) <span class="co"># make ape::phylo tree into phylobase::phylo4 S4 class</span></code></pre>
<p>The S4 class has explicitly defined it’s own plotting method, so:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bird.orders4) </code></pre>
<figure>
<img src="http://farm8.staticflickr.com/7460/10145618405_f4b1a81df8_o.png" />
</figure>
<p>However, the original S3 plotting method fails:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.phylo</span>(bird.orders4) </code></pre>
<pre><code>Error: $ operator not defined for this S4 class</code></pre>
<p>More interesting functions, many of which may not have even existed when <code>phylobase</code> was written, operate only on the S3 class:</p>
<pre class="sourceCode r"><code class="sourceCode r"> S &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">47</span>, <span class="dv">69</span>, <span class="dv">214</span>, <span class="dv">161</span>, <span class="dv">17</span>, <span class="dv">355</span>, <span class="dv">51</span>, <span class="dv">56</span>, <span class="dv">10</span>, <span class="dv">39</span>, <span class="dv">152</span>,
             <span class="dv">6</span>, <span class="dv">143</span>, <span class="dv">358</span>, <span class="dv">103</span>, <span class="dv">319</span>, <span class="dv">23</span>, <span class="dv">291</span>, <span class="dv">313</span>, <span class="dv">196</span>, <span class="dv">1027</span>, <span class="dv">5712</span>)
<span class="kw">bd.ext</span>(bird.orders4, S)   <span class="co"># Fails </span></code></pre>
<pre><code>Error: object &quot;phy&quot; is not of class &quot;phylo&quot;</code></pre>
<p>While we can work around this with explicit coercion, this requirement is rather crude and breaks existing code users may already rely upon:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bd.ext</span>(<span class="kw">as</span>(bird.orders4, <span class="st">&quot;phylo&quot;</span>), S)   <span class="co"># Works only after coercion </span></code></pre>
<pre><code>
Extended Version of the Birth-Death Models to
    Estimate Speciation and Extinction Rates

    Data: phylogenetic: as(bird.orders4, &quot;phylo&quot;) 
             taxonomic: S 
        Number of tips: 23 
              Deviance: 290.2 
        Log-likelihood: -145.1 
   Parameter estimates:
      d / b = 2.315e-08   StdErr = 0.1542 
      b - d = 0.2765   StdErr = 0.009578 
   (b: speciation rate, d: extinction rate)</code></pre>
<p>It appears this problem can be solved using <code>setOldClass</code>. I’ve defined an the class <code>phyloS4</code> which inherits all methods for the S3 <code>phylo</code> class without having to explicitly declare those methods. In this way, we have the benefits of an S4 class while maintaining compatibility with all developers who only write functions based on the S3 class. (as long as functions don’t stupidly check the string identity <code>class(obj) == &quot;phylo&quot;</code>, instead of using the proper class check <code>is(obj, &quot;phylo&quot;)</code> – looking at you <code>ape::skyline</code> and friends….)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setClass</span>(<span class="st">&quot;phyloS4&quot;</span>, 
         <span class="kw">representation</span>(<span class="dt">edge =</span> <span class="st">&quot;matrix&quot;</span>,
                        <span class="dt">Nnode =</span> <span class="st">&quot;integer&quot;</span>,
                        <span class="dt">tip.label =</span> <span class="st">&quot;character&quot;</span>,
                        <span class="dt">edge.length =</span> <span class="st">&quot;numeric&quot;</span>))
<span class="kw">setOldClass</span>(<span class="st">&quot;phylo&quot;</span>, <span class="dt">S4Class=</span><span class="st">&quot;phyloS4&quot;</span>)
<span class="kw">selectMethod</span>(<span class="st">&quot;show&quot;</span>, <span class="st">&quot;phylo&quot;</span>)
<span class="kw">removeClass</span>(<span class="st">&quot;phyloS4&quot;</span>)</code></pre>
<p><sup><a href="#fn1" class="footnoteRef" id="fnref1">1</a></sup></p>
<p>Now consider using our S4 version, rather than the phylobase S4 version:</p>
<pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;phylo&quot;</span>, bird.orders)
<span class="kw">is</span>(a, <span class="st">&quot;phylo&quot;</span>)</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bd.ext</span>(a, S)   </code></pre>
<pre><code>
Extended Version of the Birth-Death Models to
    Estimate Speciation and Extinction Rates

    Data: phylogenetic: a 
             taxonomic: S 
        Number of tips: 23 
              Deviance: 290.2 
        Log-likelihood: -145.1 
   Parameter estimates:
      d / b = 2.315e-08   StdErr = 0.1542 
      b - d = 0.2765   StdErr = 0.009578 
   (b: speciation rate, d: extinction rate)</code></pre>
<p>Class, <code>show</code>, and <code>plot</code>, and additional (<code>bd.ext</code>) methods from the S3 class just work. Now we want to extend the class to contain additional metadata (in my case, the <code>nexml</code> information):</p>
<p>I can then build a new class, <code>nexmlTree</code> by extending this class. Again my new class acts like an S3 <code>phylo</code> in any such functions, but adds a representation containing all the nexml data. This approach doesn’t minimize memory footprint, but usually that is not a concern for R users (otherwise coercion is always an option).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RNeXML)
<span class="kw">setClass</span>(<span class="st">&quot;nexmlTree&quot;</span>, <span class="kw">representation</span>(<span class="dt">nexml =</span> <span class="st">&quot;nexml&quot;</span>), <span class="dt">contains=</span><span class="st">&quot;phylo&quot;</span>)
<span class="kw">setMethod</span>(<span class="st">&quot;show&quot;</span>, <span class="st">&quot;nexmlTree&quot;</span>, function(object) <span class="kw">print.phylo</span>(object))</code></pre>
<pre><code>[1] &quot;show&quot;</code></pre>
<p>Again, we check a few methods:</p>
<pre class="sourceCode r"><code class="sourceCode r"> b &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;nexmlTree&quot;</span>, bird.orders, <span class="dt">nexml =</span> <span class="kw">as</span>(bird.orders, <span class="st">&quot;nexml&quot;</span>))
<span class="kw">is</span>(b, <span class="st">&quot;phylo&quot;</span>)</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bd.ext</span>(b, S)   </code></pre>
<pre><code>
Extended Version of the Birth-Death Models to
    Estimate Speciation and Extinction Rates

    Data: phylogenetic: b 
             taxonomic: S 
        Number of tips: 23 
              Deviance: 290.2 
        Log-likelihood: -145.1 
   Parameter estimates:
      d / b = 2.315e-08   StdErr = 0.1542 
      b - d = 0.2765   StdErr = 0.009578 
   (b: speciation rate, d: extinction rate)</code></pre>
<p>This provides the additional metadata while leaving us with an object that works with all existing functions.</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>I’m not quite sure why this required the <code>show</code> method to be defined such that we wouldn’t get the S4 show method instead. As a default show method seems to be the only method automatically defined for the new class, I gather it is the only one we have to overwrite in preference for the <code>print.phylo()</code> method.<a href="#fnref1">↩</a></p></li>
</ol>
</section>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/10/07/nexml-phylo-class-extension.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/09/25/mozilla-software-review.html">Reflections on the Mozilla Science Code Review Pilot</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 25 Sep 2013</p>

<p style="font-style:italic"> pageviews: 157 </p>

<article>
<div class="excerpt">
<p>I was recently interviewed a <em>Nature</em> senior reporter <a href="http://twitter.com/erica_check">Erika Check Hayden</a> on the subject of the scientific <a href="http://kaythaney.com/2013/08/08/experiment-exploring-code-review-for-science/">code review project</a> being conducted by <a href="https://wiki.mozilla.org/ScienceLab">Mozilla Science Lab</a>. The piece appears in this week’s issue, <a href="http://doi.org/10.1038/501472a" title="Mozilla plan seeks to debug scientific code">Hayden 2013</a>. <a href="http://carlboettiger.info/2013/06/13/what-I-look-for-in-software-papers.html">My blog post</a> sharing my own approach to code review is mentioned at the beginning of the article, though it is rather Roger Peng’s comments at the end that have stirred <a href="https://twitter.com/Erika_Check/status/382911015358181376/photo/1">some interesting discussion</a>.</p>
<p>Roger raises two concerns. First, that increased scrutiny will discourage researchers from sharing code, (which, right or wrong, remains a voluntary choice in most journals):</p>
<blockquote>
<p>One worry I have is that, with reviews like this, scientists will be even more discouraged from publishing their code</p>
</blockquote>
<p>and second, that code review does not focus on what matters mosts:</p>
<blockquote>
<p>We need to get more code out there, not improve how it looks</p>
</blockquote>
<p>(Erika provides a bit more context to Roger’s comments below).</p>
<blockquote class="twitter-tweet"><p>
<a href="https://twitter.com/ctitusbrown">@ctitusbrown</a> <a href="https://twitter.com/cboettig">@cboettig</a> <a href="https://twitter.com/kaythaney">@kaythaney</a> <a href="https://twitter.com/nickbarnes">@nickbarnes</a> see whole <a href="https://twitter.com/simplystats">@simplystats</a> quote on prof. code review discouraging sharing <a href="http://t.co/pNQWT9Safz">pic.twitter.com/pNQWT9Safz</a>
</p>
— Erika Check Hayden (@Erika_Check) <a href="https://twitter.com/Erika_Check/statuses/382911015358181376">September 25, 2013</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>The <em>Nature</em> News piece thus nails a central tension in the community between promoting higher standards for code (A position exemplified in an earlier <em>Nature</em> column titled <a href="http://doi.org/10.1038/467775a" title="Merali 2010, Nature">“Computational Science … Error: Why scientific programming does not compute”</a>, and more recently in <em>Science</em> by <a href="http://doi.org/10.1126/science.1231535" title="Joppa et al. 2013, &#39;Troubling Trends in Scientific Software Use&#39;">Joppa <em>et al.</em> 2013</a>, which explicitly calls for peer review of scientific software) vs promoting more widespread sharing of software (as exemplified by Nick Barnes piece in the same issue, <a href="http://doi.org/10.1038/467753a" title="Barnes 2010, Nature">“Publish your computer code: it is good enough”</a>.</p>
<p>The arguments made in each of the perspectives are excellent, and should be required reading for anyone interested in the subject. In addition to the shorter comment by Barnes, I also recommend the more recent <em>Nature</em> perspective, <a href="http://doi.org/10.1038/nature10836" title="Ince et al. 2012, Nature">The Case for Open Computer Programs</a>, which lays out the argument and modest practical recommendations (that have largely been ignored as far as I can tell) just brilliantly. In particular, I think they nail the issue of why describing the algorithm or providing pseudo-code is not a satisfactory description of the method.</p>
<p>However, I also think the tension between review and sharing is somewhat artificial. While each of these positions emphasizes the need to share source-code, the call for code review by Merali, Joppa et al (or in my own blog post mentioned earlier), focus on <em>scientific software</em> aimed at reuse by others. The concerns voiced in Roger Peng’s comments and echoed by Nick Barnes focus on another class of code entirely – code associated with a particular research publication that would primarily serve only to document and support those results, rather than be readily adapted to other uses.</p>
<blockquote class="twitter-tweet"><p>
<a href="https://twitter.com/cboettig">@cboettig</a> <a href="https://twitter.com/ctitusbrown">@ctitusbrown</a> <a href="https://twitter.com/kaythaney">@kaythaney</a> but far more important to get code out than to get it “right”, IYSWIM.
</p>
— Nick Barnes (@nickbarnes) <a href="https://twitter.com/nickbarnes/statuses/382746748135174144">September 25, 2013</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>



<h3 id="classes-of-code-snippets-vs-software">Classes of Code: Snippets vs Software</h3>
<p>For me, the crux of these concerns lies in the difference between “software papers”<sup><a href="#fn1" class="footnoteRef" id="fnref1">1</a></sup> and papers which merely use code in some element of the methodology. The Mozilla study focused exclusively on code appearing in the full-text of publications in PLoS Computational Biology. Though I am pleased to see the Science Lab tackle the issue of software review and bring the expertise of their professional software developers to bear on scientific code, this is perhaps not the kind of code I would have chosen to focus on (something I shared with the team early on in seeing the announcement).</p>
<p>Without knowing which papers are included it is of course difficult to say to much. But knowing that the code appears in the full text of the papers themselves, we can assume that it is not a complete software package intended for reuse by other researchers. Using code within the body of a manuscript implies the intent to communicate methodology more concisely and precisely than might be done in prose; in much the same manner that we use equations in place of prose. This is an important development in scientific communication, but is also rather distinct from the use of code in other contexts, in which the code itself is meant to be read primarily by machines. It is code that is already intended to help <em>explain</em>.</p>
<p>Code included in appendices to scientific papers is meant rather to <em>document</em> exactly what has been done, in a manner that assists replication, and may require considerable effort to decipher exactly what is being done. Instead, it merely supports the more readable but less precise description and potentially the pseudo-code that would appear in the body text.</p>
<p>Code intended for reuse as research software (in software papers) is another class entirely. Ostensibly, the user never needs to see the code itself, but only interact with the user interface or end-user functions (API) provided. Code that is written clearly and concisely still has value – helping identify bugs and facilitating future researcher-developers extending the software, but most of it’s functionality can be accessed and assessed without looking at the source. I think it is in this kind of review that we as a researcher-developer community could learn the most from the Mozilla software engineering experts.</p>
<p>I believe the most important focus of code review is in scientific software rather than in code snippets. And in reviewing software, I think all of the most important elements do not actually involve reading the source code at all (as I discuss in my <a href="http://carlboettiger.info/2013/07/09/reviewing-software-revisited.html">revised position on reviewing software papers</a>), but rather in establishing that the software behaves as expected and follows software development practices that make it more sustainable, such as hosting in a software repository, version control, or example input and output.</p>
<h3 id="code-vanity">Code vanity?</h3>
<p>Roger’s second comment appears more dismissive of code review than I think it actually is:</p>
<blockquote>
<p>“We need to get more code out there, not improve how it looks.”</p>
</blockquote>
<blockquote class="twitter-tweet"><p>
<a href="https://twitter.com/kaythaney">@kaythaney</a> <a href="https://twitter.com/ctitusbrown">@ctitusbrown</a> yup, ‘pretty’ is dismissive terminology, though possibly short-hand for ‘human-readable’ not just ‘machine-readable’
</p>
— Carl Boettiger (@cboettig) <a href="https://twitter.com/cboettig/statuses/382905327013728256">September 25, 2013</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Most modern languages include <a href="http://en.wikipedia.org/wiki/Syntactic_sugar">syntactic sugar</a>: ways of expressing commands that are more easily interpretable to human readers. For instance, in C, <code>a[i]</code> is syntactic sugar for <code>*(a+i)</code>. Higher-level languages are in some ways all sugar around existing lower-level libraries.<sup><a href="#fn2" class="footnoteRef" id="fnref2">2</a></sup> Like good mathematical notation or good prose, this is not just about being ‘pretty’, but being more effective in communicating with humans. Certainly this is something we can improve upon as researchers, but it is perhaps not the best starting point.</p>
<h3 id="share-first-fix-later">Share first, fix later</h3>
<p>If code review should apply to all levels of code or be reserved for scientific software may still be an open question. What we should be able to agree on is in the publishing of code in the first place:</p>
<blockquote class="twitter-tweet"><p>
<a href="https://twitter.com/cboettig">@cboettig</a> <a href="https://twitter.com/kaythaney">@kaythaney</a> <a href="https://twitter.com/nickbarnes">@nickbarnes</a> I think code sharing should be mandatory <em>shrug</em>. It's part of the methods. I reject papers w/o it.
</p>
— Titus Brown (@ctitusbrown) <a href="https://twitter.com/ctitusbrown/statuses/382903924253929472">September 25, 2013</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>It continues to surprise me how few journals require code deposition. <em>Science</em> explicitly <a href="http://doi.org/10.1126/science.1203354">adopted a new policy in 2011</a> stating</p>
<blockquote>
<p><em>Science</em> is extending our data access requirement listed above to include computer codes involved in the creation or analysis of data</p>
</blockquote>
<p>which asks that the data be placed in a appropriate permanent repository or otherwise placed in the supplementary materials (see <a href="http://www.sciencemag.org/site/feature/contribinfo/prep/gen_info.xhtml#dataavail">information for authors</a>).</p>
<p>Yet I have not seen code provided for any analysis I have read in Science since 2011. Either we have a very different understanding of what it means to use computer codes in the analysis of data or <em>Science</em> grossly neglects its own policy.<sup><a href="#fn3" class="footnoteRef" id="fnref3">3</a></sup> Not to pick on them of course, few other journals have explicitly adopted such a policy.</p>
<blockquote class="twitter-tweet"><p>
.<a href="https://twitter.com/cboettig">@cboettig</a> <a href="https://twitter.com/kaythaney">@kaythaney</a> <a href="https://twitter.com/nickbarnes">@nickbarnes</a> As one of my grad students said to me, “I don't understand why ‘must share code’ is a radical opinion.”
</p>
— Titus Brown (@ctitusbrown) <a href="https://twitter.com/ctitusbrown/statuses/382904483102982145">September 25, 2013</a>
</blockquote>


<p>Nick Barnes suggests that this alone may be enough to improve code quality:</p>
<blockquote class="twitter-tweet"><p>
<a href="https://twitter.com/cboettig">@cboettig</a> <a href="https://twitter.com/ctitusbrown">@ctitusbrown</a> <a href="https://twitter.com/kaythaney">@kaythaney</a> require sharing. Pride will then rapidly lead to review and other improvement techniques.
</p>
— Nick Barnes (@nickbarnes) <a href="https://twitter.com/nickbarnes/statuses/382755320143282176">September 25, 2013</a>
</blockquote>

<p>Certainly it will help, though not enough if the state of open source scientific software is any indication (Nick does acknowledge a rather geological notion of ‘rapid’). Smaller codes used in particular analyses will certainly feel this pressure more, as they will be easier to scrutinize.</p>
<h3 id="so-what-might-we-learn-from-the-mozilla-code-review">So what might we learn from the Mozilla Code review?</h3>
<p>Focusing on code appearing in-line in papers certainly addresses a different beast than large scientific software packages intended for reuse. As Roger observed, we will likely learn that scientists aren’t software engineers. We may learn how to use code to communicate more effectively. We may learn some lessons that apply for larger codebases involved in scientific software, but I think there the problem are often outside of the individual lines of code themselves and arise from other development practices.</p>
<p>Still, learning how to do code review at all would be an invaluable start. As the discussion on my own post on the subject made clear, we researchers have no training in this practice. The Mozilla study would give the first taste. I only hope they turn there attention next to larger scientific software that lives outside of the publications themselves and is intended at re-purposing and reuse. Meanwhile, I also hope journals will become more serious about recognizing code as methods, as they have started to do with data.</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>which I define as papers primarily aimed at promoting the reuse of a particular codebase and providing an indexed citation target to credit the work.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>It is frequently argued that ideal code should be ‘self-documenting’, with syntax so precise that no other explanation of the function is necessary. While I think this is an admirable ideal, it should never be a substitute for actually providing prose documentation as well. I find we too easily decieve ourselves as to just how self-documenting our own code really is (it’s all so obvious at the time, right?).<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>From my reading it appears that <em>Science</em> requirements are intentionally too vague on this issue, stating: “All computer codes involved in the creation or analysis of data must also be available to any reader of Science.” It is unclear if ‘available on request’ is considered appropriate for code, though it is explicitly not acceptable for data: “we have therefore required authors to enter into an archiving agreement, in which the author commits to archive the data on an institutional Web site, with a copy of the data held at Science”, and the editorial makes it clear that “the data access requirement … includes computer codes”. Meanwhile all studies involving ‘requests for data’ have shown a return rate of substantially less than a 100% (usually less than 20%, e.g. <a href="http://doi.org/10.1371/journal.pbio.1001636">this recent study</a>). If that was a viable option we could just publish abstracts and have papers available on request too. If you need to know who wants your data, why not do the same for papers?<a href="#fnref3">↩</a></p></li>
</ol>
</section>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/25/mozilla-software-review.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
    </div>

    <div class="row">
      
        <div class="span3">
          <header><h4><a href="/2013/09/23/notes.html">Notes</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 23 Sep 2013</p>

<p style="font-style:italic"> pageviews: 14 </p>

<article>
<div class="excerpt">
<h3 id="nonparametric-bayes">nonparametric bayes</h3>
<h4 id="reading">Reading</h4>
<ol type="1">
<li>Arnqvist, G. 2013 Editorial rejects? Novelty, schnovelty! Trends in ecology &amp; evolution 28, 448–9. (doi:10.1016/j.tree.2013.05.007)</li>
<li>Accounting for Complementarity to Maximize Monitoring Power for Species Management. 27, 988–999. (doi:10.1111/cobi.12092)</li>
<li>Nes, E. H. Van, Hirota, M., Holmgren, M. &amp; Scheffer, M. 2013 Tipping points in tropical tree cover: linking theory to data. (doi:10.1111/gcb.12398)</li>
<li>Millar, R. B. 2002 Reference priors for Bayesian fisheries models. , 1492–1502. (doi:10.1139/F02-108)</li>
<li>Mcallister, M. K. &amp; Kirkwood, G. P. 1998 Bayesian stock assessment : a review and example application using the logistic model. , 1031–1060.</li>
</ol>
<h4 id="writing">writing</h4>
<ul>
<li><p>reorganizing, re-writing in intro.</p></li>
<li>technical issues:</li>
<li>pandoc 1.12 citation formating issues? How to use bibtex now?<br /></li>
<li><p>Makefile add dependency flags. Yay, brilliant.</p></li>
</ul>
<h3 id="informatics-ropensci">Informatics / ropensci</h3>
<ul>
<li><p>Interesting discussion with Dave Bridges over semantic metadata in regards to his <a href="http://bridgeslab.uthsc.edu/data-resource-sharing#comment-1056466868">data management plan</a></p></li>
<li><p>Karthik asks for thoughts on sustainability in advance of our meeting this fall.</p></li>
<li><p>Scott’s <code>taxize_</code> paper is out (Chamberlain, S. a. &amp; Szöcs, E. 2013 taxize: taxonomic search and retrieval in R. F1000Research 191, 1–20. doi:10.12688/f1000research.2-191.v1) Great, but also appears F1000 (and everyone else, including both my software papers) does a terrible job with code display in papers. Ought to have a more general open letter to publishers on this (Scott writing blog post on issue – yay). Sent this to F1000Research:</p></li>
</ul>
<blockquote>
<p>Congrats on publishing http://f1000research.com/articles/2-191/v1 This looks like a promising article. Your support of research containing software, with support for features such as continual updating as the software improves, is an invaluable contribution to an crucial and frequently neglected element of academic research, and your innovative publishing workflow with visible and signed reviewer comments a welcome addition to the academic publishing landscape.</p>
</blockquote>
<blockquote>
<p>Overall the presentation of your HTML and pdf manuscripts looks quite strong. (I particularly appreciate the linked pdf and the availability of XML version).</p>
</blockquote>
<blockquote>
<p>It is most unfortunate that code blocks appear as gifs rather than as text (in PDF, HTML, and XML versions). Being able to copy-paste code chunks is a valuable element to ensure reproducible output of the author’s provided code, and this is severely hampered by the use of the GIFs. Though I can copy the text for the most part from the GIF, certain characters are not ASCII encoded, so that commas, for instance, appear not as plain-text ASCII but as a UTF-8 comma symbol I don’t recognize, and which will not work in code.</p>
</blockquote>
<blockquote>
<p>As you strive to bring publication into the 21st century, please consider addressing this important issue. All lines of code should be machine-readable in the XML, not images, and should use only the ASCII characters they actually involve.</p>
</blockquote>
<h3 id="evolution-thinking">evolution thinking</h3>
<p>After another email on the topic, am assembling thoughts on comparative methods promises and pitfalls. Might be worth flushing out into proper post / article at some point. A broader version of the more narrower opinion I’ve been toying with writing for some time (beyond phylogenetic signal; or phylogenetic signal is not biologically meaningful). Similar statements should be made of rates.</p>
<hr />
<p>Yes, so it’s a good question of just how meaningful that would be. I believe that assigning some Markovian process to some property associated with a species (e.g. Markov chain to categories, BM/OU to some continuous trait) in general is exciting but potentially dicey even in the context that we already apply the phylogenetic comparative method. Um, summarizing roughly, I think i have 3 concerns. (Take with a grain of salt, I’m probably on the far end of skepticism with regards to this stuff, and not completely up to date these days either).</p>
<p><strong>Applicability</strong>. It should be reasonable to think of the trait in question as evolving under the hypothesized model (at least approximately). For instance, Brownian Motion may not seem like a very biological model except for purely neutral processes, but I find it 100% reasonable as an approximation to lots of processes. Other models/statistics in this area I do not – such as Pagel’s lambda, because it treats tips differently from the rest of the tree and obviously evolution has no idea if it is on a tip or not. Without a clear picture of the quantities you have in mind it would be difficult for me to be sure how comfortable I am with it.</p>
<p><strong>Power</strong>. As the models get richer, clearly our ability to meaningfully distinguish between them goes down. This isn’t much of a problem in Bayesian framework, since we just get posteriors that look like our priors and we realize we haven’t learned anything, but it can be more misleading in a frequentist framework (though the method I take in that Evolution paper, based on frequentist methods from Huelsenbeck and others in the 1990s (and really Cox in the 1960s) tries to address that in a fequentist way instead).</p>
<p><strong>Identifiability</strong>. Other difficulties are more troublesome. A central tenant of the approach is to assume evolution on independent branches is independent – clearly a bit of a strange assumption when the process is supposed to capture competition between species that might lead to different niches, etc. However, relaxing this assumption (a growing interest recently) is yet more troublesome, since the tree no longer tells us much if traits can be correlated for reasons other than shared evolutionary history. This is just one of many ways we get a stronger problem than power – we have non-identifiable elements in our model, where we can explain the data equally effectively with different representations. (This arises in simpler models too of course).</p>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/23/notes.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/09/19/notes.html">Notes</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 19 Sep 2013</p>

<p style="font-style:italic"> pageviews: 22 </p>

<article>
<div class="excerpt">
<ul>
<li>writing manuscript</li>
<li>slides</li>
<li>data request to Glaser.</li>
</ul>
<h3 id="gpdd">gpdd</h3>
<ul>
<li><a href="http://www3.imperial.ac.uk/cpb/databases/gpdd">Global Popluation Dynamics Database</a> initiated package <a href="https://github.com/ropensci/rgpdd">rgpdd</a></li>
<li>data extraction – No API, but does provide direct dump in the form of a Microsoft Access <code>mdb</code> database. For the moment I’m using mdbtools: <code>mdb-tables</code> and <code>mdb-extract</code> to convert to CSV and then reading those into R. <a href="http://cran.r-project.org/web/packages/RODBC/index.html">RODBC</a> package installs but cannot read the database directly for me. Since data will fit into working memory no real reason to support database calls from R? (avoids extra dependencies). <code>data.table</code> should speed internal computations.<br /></li>
<li>data compression. Looks like raw data exceeds CRAN’s 5MB limit, but <code>zx</code> compressed binaries it will be less than <span class="math">\(&lt;0.4\)</span> MB. Compressing those from within R: <code>save(table_name, file=&quot;filename.rda&quot;, compress=&quot;xz&quot;)</code>. Looks like database is essentially static with updates every few years, see <a href="http://www3.imperial.ac.uk/cpb/databases/gpdd/updates">Updates page</a>. Together this makes a good case for distributing data directly in the package.</li>
</ul>
<p>On distributing the data, note:</p>
<p>“Not all of the data in GPDD is in the public domain; some are provided under licence from the BTO. We require permission before we can distribute some of the data sets. The data in these datasets have been removed from the DATA table in this online version of GPDD, but the metadata in the other tables has been left in place.” http://www3.imperial.ac.uk/cpb/databases/gpdd/structure</p>
<p>Emailed database providers to confirm.</p>
<h3 id="gpdd-related-reading">GPDD-related reading</h3>
<ol type="1">
<li>Post, E., Brodie, J., Hebblewhite, M., Anders, A. D., Maier, J. a. K. &amp; Wilmers, C. C. 2009 Global Population Dynamics and Hot Spots of Response to Climate Change. BioScience 59, 489–497. (doi:10.1525/bio.2009.59.6.7)</li>
<li>Knape, J. &amp; de Valpine, P. 2012 Are patterns of density dependence in the Global Population Dynamics Database driven by uncertainty about population abundance? Ecology Letters 15, 17–23. (doi:10.1111/j.1461-0248.2011.01702.x)</li>
<li>Sibly, R. M., Barker, D., Denham, M. C., Hone, J. &amp; Pagel, M. 2005 On the regulation of populations of mammals, birds, fish, and insects. Science (New York, N.Y.) 309, 607–10. (doi:10.1126/science.1110760)</li>
</ol>
<h3 id="notebook-infrastructure">Notebook infrastructure</h3>
<ul>
<li><p>ugh should implement script to transform DOIs to links+metadata. probably <code>knitcitations</code> based, but without needing the verbose <code>r citep(&quot;</code> notation. pity markdown doesn’t support <code>rel</code> attribute on links. Maybe possible already? https://drupal.org/node/421832 No luck there, though pandoc can avoid choking on this style of link attribute: https://github.com/jgm/pandoc/wiki/Pandoc-vs-Multimarkdown#image-and-link-attributes when compiling with <code>-f markdown+link_attributes</code>. Unfortunately this doesn’t actually render the attributes but just silently drops them.</p></li>
<li><p>Adjust link to provide turtle instead of RDF/XML (avoid the download prompt)?</p></li>
</ul>
<h3 id="interview-follow-up-links">Interview follow-up links</h3>
<ul>
<li><p>I mentioned my involvement started with <a href="http://carlboettiger.info/2013/06/13/what-I-look-for-in-software-papers.html">this post</a>; the (somewhat long) comments are useful.</p></li>
<li><p>I should have mentioned that recently attended a workshop where environmental scientists were thinking about how to approach these issues related to software and code through the creation of a <a href="http://isees.nceas.ucsb.edu">Software Sustainability Center</a>. (Of which code review could be one possible service it might provide).</p></li>
<li><p>I might have mentioned that a few organizations are doing code review. Notably, the journal of open research, published by the new UK Software Sustainability Institute. They are one of the few organziations that have <a href="http://carlboettiger.info/2013/07/09/reviewing-software-revisited.html">code review guidelines</a></p></li>
<li><p>Code review was recently <a href="http://dx.doi.org/10.1126/science.1231535">proposed</a> and <a href="http://dx.doi.org/10.1126/science.341.6143.236-b">disputed</a> in a Policy Forum piece in Science Magazine discussing these issues.</p></li>
<li><p>This Times Higher Ed article recently highlighted the issues with Climate code: http://www.timeshighereducation.co.uk/news/save-your-work-give-software-engineers-a-career-track/2006431.article The Climate Code Foundation http://climatecode.org/ is doing excellent work to start addressing these issues.</p></li>
<li><p>Of course several earlier articles in Nature have highlighted these issues, including the important tension between encouraging scientists to <a href="http://doi.org/10.1038/nature10836">share code even if it isn’t “pretty”</a>, vs <a href="http://doi.org/10.1038/467775a">improving the quality / readability of code</a>.</p></li>
</ul>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/19/notes.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/09/18/notes.html">Notes</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 18 Sep 2013</p>

<p style="font-style:italic"> pageviews: 14 </p>

<article>
<div class="excerpt">
<ul>
<li>nonparametric-bayes writing writing. see commits.</li>
<li>Started slides for Mangel group retreat. (in progress).</li>
<li>Working on requested review… background reading too.</li>
<li>reml read methods for <code>data.set</code> class, extending <code>attributeList</code> metadata tools.</li>
</ul>
<h3 id="scribble-notes-for-interivew">Scribble notes for interivew</h3>
<ul>
<li>we are where math was 400 years ago - present theorem without proof.<br /></li>
<li>code plays an ever-increasing role in our research, and hence in describing what we have done</li>
<li>potentially the most precise and consise way to describe a method. Also potentially the most obuscated or incoherent</li>
<li><p>we value writing. we value clean and documented wet lab technique.</p></li>
<li>inline code vs software papers. Mozilla will focus on the former. the latter is more difficult.</li>
<li><p>practices external to the code itself matter – maintenance, test suites, version control</p></li>
</ul>
<h3 id="reading">Reading</h3>
<h4 id="structural-uncertainty-etc">structural uncertainty, etc</h4>
<ol type="1">
<li>Weitzman, M. L. Landing Fees vs Harvest Quotas with Uncertain Fish Stocks. Journal of Environmental Economics and Management 43, 325–338 (2002). (doi:10.1006/jeem.2000.1181)</li>
<li>Weitzman, M. L. A Precautionary Tale of Uncertain Tail Fattening. Environmental and Resource Economics 55, 159–173 (2013). (doi:10.1007/s10640-013-9646-y)</li>
<li>Weitzman, M. Structural uncertainty and the value of statistical life in the economics of catastrophic climate change. (2007). at <a href="http://www.nber.org/papers/w13490">http://www.nber.org/papers/w13490</a></li>
</ol>
<h4 id="ecoinformatics">ecoinformatics</h4>
<ol start="5" type="1">
<li>Smith, V. et al. Beyond dead trees: integrating the scientific process in the Biodiversity Data Journal. Biodiversity Data Journal 1, e995 (2013). (doi:10.3897/BDJ.1.e995)</li>
</ol>
<h5 id="methodology">methodology</h5>
<ol start="7" type="1">
<li>Millar, R., Anderson, M. &amp; Zunun, G. 2005 Fitting nonlinear environmental gradients to community data: a general distance-based approach. Ecology 86, 2245–2251.</li>
<li>McArdle, B. &amp; Anderson, M. 2001 Fitting multivariate models to community data: a comment on distance-based redundancy analysis. Ecology 82, 290–297.</li>
</ol>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/18/notes.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
    </div>

    <div class="row">
      
        <div class="span3">
          <header><h4><a href="/2013/09/16/notes.html">Notes</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 16 Sep 2013</p>

<p style="font-style:italic"> pageviews: 11 </p>

<article>
<div class="excerpt">
<ul>
<li>finish up and push backlog of notebook updates</li>
<li>[x] knitcitations slidify (issue <a href="https://github.com/cboettig/knitcitations/issues/46">46</a>)</li>
<li>recently resolved several further issues/requests with rfishbase</li>
</ul>
<h2 id="ropensci">ropensci</h2>
<p>Have implemented a solution to extending <code>data.frame</code> with metadata that I was <a href="http://carlboettiger.info/2013/09/11/extending-data-frame-class.html">tackling the other day</a>. This raises several open questions on how we do the implementation, including whether we restrict this extension to providing the <code>attributeList</code>-level metadata (or a subset thereof), or if we allow higher level nodes of <code>eml</code> to act as extensions of <code>data.frame</code> (e.g. <code>dataTable</code>, which provides additional metadata attributes such as <code>entityTitle</code>, as well as the <code>physical</code> description of the <code>csv</code> file.</p>
<p>Matt raises good points about what attribute data we want. Most we have addressed already, but this does raise additional challenges as well. See issue <a href="https://github.com/ropensci/reml/issues/47">#47</a> for details and further discussion.</p>
<h2 id="reading">Reading</h2>
<p>Started catching up on some backlog of warning signals literature.</p>
<ul>
<li><a href="http://dx.doi.org/10.1890/12-0670.1" title="Rising catch variability preceded historical fisheries collapses in Alaska">Litzow et al, Ecology</a></li>
<li><a href="http://dx.doi.org/10.1016/j.jtbi.2013.08.011" title="Predicting critical transitions in a model of systemic inflammation">Scheff et al, JTB</a></li>
<li><a href="http://dx.doi.org/10.1109/ICNF.2013.6578895" title="Signals of critical transitions in ecosystems associated with fluctuations of spatial patterns">Corrado et al,</a></li>
<li><a href="http://arxiv.org/abs/1307.8250" title="Critical Transitions in Social Network Activity">Kuhn et al, arXiv</a>. Because something is a event (e.g. Thanksgiving) doesn’t make it a “critical transition”… What’s the state-space? The slowly-changing parameter? What’s the model?</li>
<li><a href="http://doi.org/10.1086/670930" title="Warning Signals of Regime Shifts as Intrinsic Properties of Endogenous Dynamics">Fung et al, AmNat</a></li>
</ul>
<h2 id="writing">Writing</h2>
<p>writing writing</p>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/16/notes.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/09/11/extending-data-frame-class.html">Extending Data Frame Class</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 11 Sep 2013</p>

<p style="font-style:italic"> pageviews: 32 </p>

<article>
<div class="excerpt">
<p>I’d like to define a class that acts just like a <code>data.frame</code>, just like the <code>data.table</code> class does, but contains some additional metadata (e.g. the units associated with the columns) and has some additional methods associated with it (e.g. that might do something with those units) while also working with any function that simply knows how to handle <code>data.frame</code> objects.</p>
<p>How might this be done?</p>
<hr />
<p><em>I’m not really sure where to start on this, so below is a summary of my attempt so far and some further puzzles I have stumbled across (e.g. is a <code>data.frame</code> and S4 object?). This seems to work, but might not be the best way to go about it.</em></p>
<hr />
<p>If I understood what the data structure underlying <code>data.frame</code> was, I might have a better idea how to extend it. But I don’t know what makes a <code>data.frame</code> a <code>data.frame</code>, as the exploration below will illustrate:</p>
<p>For instance, it’s not clear if I should try writing my extended object as an S3 or an S4 object that inherits <code>data.frame</code>. When is a <code>data.frame</code> an S4 object and when is it an S3 object?</p>
<pre><code>A &lt;- new(&quot;data.frame&quot;)
isS4(A) </code></pre>
<p>returns <code>TRUE</code>, suggesting that data.frames are S4 objects and that we might start with: <code>setClass(&quot;myclass&quot;, contains=&quot;data.frame&quot;)</code>. However,</p>
<pre><code>B &lt;- data.frame(x = rnorm(10))
isS4(B) </code></pre>
<p>returns <code>FALSE</code>, suggesting that <code>data.frames</code> are S3 classes, and perhaps I should consider starting with</p>
<p>attr(B, “class”) &lt;- c(“myclass”, “data.frame”)</p>
<p>It appears that a data.frame is built upon a list, since</p>
<pre><code>is.list(data.frame(x = rnorm(10)))</code></pre>
<p>gives <code>TRUE</code>.</p>
<p>Despite <code>isS4(B)</code> being <code>FALSE</code>, we find that the S4 method <code>slotNames(B)</code> gives:</p>
<pre><code>&gt; slotNames(B)
[1] &quot;.Data&quot;     &quot;names&quot;     &quot;row.names&quot; &quot;.S3Class&quot; </code></pre>
<p>suggesting that <code>data.frame</code> is an S4 object, with a (unnamed?) list in <code>.Data</code> and nonempty values in <code>names</code>, along with the slot “.S3Class” containing the string “data.frame”.</p>
<p>Interestingly:</p>
<ul>
<li><code>B@names</code> returns an error, while <code>slot(B, &quot;names&quot;)</code> returns <code>&quot;x&quot;</code>. (Suggesting <code>B</code> is S3, with some <code>slot</code> method defined?)<br /></li>
<li><code>B@.Data</code> returns an unnamed length-1 list containing a numeric vector with our 10 random values. (and illustrating a working <code>@</code> accessor, suggesting <code>B</code> is S4.)</li>
</ul>
<p>Very confusing.</p>
<hr />
<p>From this exploration, I conclude that I can promote a <code>list</code> to a <code>data.frame</code> by providing an unnamed list, editing the “class” attribute, and then assigning values to the slots <code>names</code> and <code>row.names</code>:</p>
<pre><code>obj &lt;- list(rnorm(10))
attr(obj, &quot;class&quot;) &lt;- &quot;data.frame&quot;
slot(obj, &quot;names&quot;) &lt;- &quot;x&quot;
slot(obj, &quot;row.names&quot;) &lt;- 1:10</code></pre>
<p>And indeed <code>obj</code> acts like a proper <code>data.frame</code> (at least it prints like one).</p>
<p>This suggests that I could extend <code>data.frame</code> by adding a new slot for my units, like so:</p>
<p>setClass(“myclass”, representation(units = “character”), contains=“data.frame”)</p>
<p>But this does not inherit the slotNames <code>names</code>, <code>row.names</code>, <code>.S3Class</code>. I try assigning these explicitly,</p>
<pre><code>setClass(&quot;myclass&quot;, 
         representation(units = &quot;character&quot;,
                        names = &quot;character&quot;,
                        row.names = &quot;integer&quot;,
                        .S3Class = &quot;character&quot;),
                        contains = &quot;list&quot;)

obj &lt;- new(&quot;myclass&quot;, names=&quot;x&quot;, row.names=1:10, units = &quot;degrees Celsius&quot;)
obj@.Data &lt;- list(rnorm(10))
obj@.S3Class &lt;- &quot;data.frame&quot;</code></pre>
<p>but this new object is not a <code>data.frame</code>. Finally we add</p>
<pre><code>attr(obj, &quot;class&quot;) &lt;- &quot;data.frame&quot; </code></pre>
<p>and we have a successful extension that acts like a data frame. Some weird things of note: It appears that .S3Class needs to be assigned as above with <code>@</code>, and not as a named argument in <code>new</code> or as part of the <code>prototype</code>.</p>
<p>This last step is almost certainly not what we really want to do, since it destroys our new class assigment (<code>myclass</code>). We really want the object to have two classes, <code>myclass</code> and <code>data.frame</code>. However, if we do <code>attr(obj, &quot;class&quot;) &lt;- c(&quot;myclass&quot;, &quot;data.frame&quot;)</code>, then the object does not behave as a <code>data.frame</code> at all.</p>
<p>One might thing that the solution would be to then define all the S3 methods as copies of those avialable for data.frames, e.g. define <code>print.myclass &lt;- print.data.frame</code>. Unfortunately this doesn’t quite work (appears not to get <code>row.names</code> and hence prints column headings but not data. Defining the S4 method for <code>row.names</code> with <code>myclass</code> signature doesn’t fix this either…).</p>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/11/extending-data-frame-class.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
        <div class="span3">
          <header><h4><a href="/2013/09/11/ISEES-Workforce-Development-Day-2.html">Isees Workforce Development Day 2</a></h4></header>
<p><span></span></p>
<p style="font-style:italic"> 11 Sep 2013</p>

<p style="font-style:italic"> pageviews: 15 </p>

<article>
<div class="excerpt">
<p>Near the end of another excellent day of discussions we were asked to put pen to paper to outline our own views in writing. My own contribution was the following notebook scribble.</p>
<hr />
<p><em>My own vision of what ISEES should be doing for workforce development:</em></p>
<p>ISEES would employ a multi-scale approach to improve basic computational expertise across the entire workforce necessary to fully participate in the modern software-immersed world of research through the development of <em>training standards</em>, while using a <em>working-group model</em> focused on emerging researcher-developer communities which would simultaneously improve the quality and synthesis of existing software tools while also delivering essential skills to the most transformative members of the research software communities.</p>
<p>Development and promotion of standards for computational training. A workshop model could allow these to be written and updated by the community. These could serve as a guideline for curriculum development and play a key role in assessment. Curriculum review panels within departments, as well as reviewers of grants which include a component of computational training, would at least have such consensus standards to which they could point, either to reject sub-standard practices or make the case for increased resources to meet these goals. Curriculum should be geared towards inclusion of this training as part of domain-specific classes rather than extramural classes.</p>
<p>Working groups or hack-a-thons bringing together “researcher-developer” domain scientists with software engineering experts would simultaneously provide a direct benefit to “hardening” (improving the interoperability, scalability, and sustainability) of existing software while also training the most influential members of the research community who are most frequently involved in training other domain scientists. By organizing such working groups around existing research communities, the incentive to participate would be higher as the outputs would be more directly aligned with existing research programmes, while at the same time training the researchers most active in software development in their domain and most likely to teach these skills to others.</p>
<p>Thirdly, ISEES should support workshops or small conferences to address developing concerns in software workforce training, including issues such as assessing current training practices, measuring improvement and the impact of the center, or challenges in software career paths.</p>
<hr />
<p>Didn’t really jot many notes down in today’s session, but will instead link the excellent prepared by our awesome expert facilitator <a href="https://twitter.com/ninmah">Rachel Smith</a>.</p>
<figure>
<img src="http://farm4.staticflickr.com/3807/9727344142_8d449003a7_c.jpg" />
</figure>
<figure>
<img src="http://farm4.staticflickr.com/3727/9724949449_a5a7998b6c_c.jpg" />
</figure>
 
<!-- not that raw_content depends on custom generator, 
     see _plugins/jekyll-labnotebook-plugins/raw_content --> 
</article> 
<p> <a href="/2013/09/11/ISEES-Workforce-Development-Day-2.html"> <em>Read more</em></a> </p>
<br />
<br />


        </div>
      
    </div>

  </div>
</div> <!--end row -->

<div class="row">
  <div class="span11 offset1">
    <div class="socialicons">
      <p> <a href="/archive.html"><i class="icon-calendar"></i> All entries by date</a></p> 
      <p> <a href="/categories.html"><i class="icon-list"></i> All entries by category</a> </p>
      <p> <a href="/tags.html"><i class="icon-tags"></i> All entries by tag</a> </p>
    </div>
  </div> <!--end span9 -->
</div> <!--end row -->




<footer class="footer">
  <!-- ************* Buttons to toggle theme CSS ********************** -->
    <div class="row">
      <div class="span12">
        <form style="font-size:10px" class="pull-right">
          <a onclick="switch_style('dark'); 
                      recordOutboundLink(this, 'Outbound Links', 'dark theme'); 
                      return false;" 
             name="theme" value="dark" id="dark" 
             class="btn btn-mini"><span class="showtooltip" 
                                        title="switch to dark theme"><i class="icon-adjust"></i>
                                   </span></a>
          
          <a onclick="switch_style('light'); 
                      recordOutboundLink(this, 'Outbound Links', 'light theme'); 
                      return false;" 
             name="theme" value="light" id="light" 
             class="btn btn-mini"><span class="showtooltip" 
                                        title="switch to light theme"><i class="icon-certificate"></i>
                                  </span></a>


           <a onclick="switch_style('white'); 
                      recordOutboundLink(this, 'Outbound Links', 'white theme'); 
                      return false;" 
             name="theme" value="white" id="white" 
             class="btn btn-mini"><span class="showtooltip" 
                                        title="switch to white theme"><i class="icon-circle-blank"></i>
                                 </span></a>
        </form>
      </div>
    </div>

<!--************** FOAF information to social networks ***************************** -->
  <div class="row">
    <div class="span3 socialicons" style="font-size:20px" typeof="foaf:Person" about="http://carlboettiger.info#me">
      <p>
          <script type="text/javascript" src="/assets/js/obfuscate-email-link.js" language="javascript"></script> 
          <a rel="foaf:account" alt="twitter" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="icon-twitter"></i></span></a> 
          <a rel="foaf:account" alt="github" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="icon-github"></i></span></a>
      <!--
          <a rel="foaf:account" href="https://plus.google.com/" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); 
             return false;"><i class="icon-google-plus"></i></a>
          <a rel="foaf:account" href="http://www.mendeley.com/profiles/carl-boettiger" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); 
             return false;"><img src="/assets/img/icon-mendeley.png" alt="mendeley" /></a> 
           citations on google-scholar
           stackoverflow
      -->
      <a alt="rss" type="application/atom+xml" href="/blog.xml"  
         class="showtooltip" title="RSS feeds for my blog-style entries. See the feed on my lab notebook (/atom.xml) to follow all entries instead." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="icon-rss"></i></a>
       </p>
    </div>
    <!--**************** End social links **************************** -->
    <div class="span1">
      <br />
    </div>
    <div class="span4">
      <p>
      <a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="http://onsclaims.wikispaces.com/file/view/ons-aci2-icon.png" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a>

      <a title="This site uses linked data semantics. Click to extract as RDF XML." class="btn btn-mini showtooltip" style="font-size: .8em" 
       href="http://any23.org/?format=rdfxml&validate=validate&uri=http://carlboettiger.info/lab-notebook.html"><i 
         class="icon-cloud-download"  onclick="recordOutboundLink(this, 'Outbound Links', 'RDF'); return false;"></i> RDF</a>
      </p>
    </div>
    <div class="span1">
      <br />
    </div>
    <div class="span3">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="http://i.creativecommons.org/l/zero/1.0/88x31.png" alt="CC0"/></a> 
      </p>
    </div>

  </div>
  
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=Lab Notebook
      &amp;rft.creator=Carl Boettiger
      &amp;rft.date=
      &amp;rft.language=EN
      &amp;rft.rights=CC0
      &amp;rft_id=http://carlboettiger.info/lab-notebook.html">
  </span>



</footer>




    <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script type="text/javascript" src="/assets/js/jquery.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="/assets/js/bootstrap.min.js"></script>
    <!-- Tooltip javascript -->
    <script type="text/javascript">
      $(document).ready(function (){
        $(".showtooltip").tooltip();
      });
    </script>

    <!-- Marran's Search Javascript -->
    <script type="text/javascript" src="/assets/js/porter-stemmer.js"></script>
    <script type="text/javascript" src="/assets/js/site-search.js"></script>

    <!-- Code collapse Javascript -->
    <script type="text/javascript">
    $(document).ready(function(){
      $("#toggle_code").click(function(){
        $(".highlight").toggle();
        $(".sourceCode").toggle();
      });
    });
    </script>


  <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>




    


    </div>
  </body>
</html>

