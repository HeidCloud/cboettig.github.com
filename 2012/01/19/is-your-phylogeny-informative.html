<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8" /> 
    <title>Is your phylogeny informative?</title>
    <meta name="author" content="Carl Boettiger" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

  


<!-- HTML5 metadata -->
<meta name="keywords" content="Science, Ecology, Evolution, Open Science, Reproducible Research" />
<meta name="description" content="My open lab notebook- research in theoretical ecology and evolution" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Is your phylogeny informative?" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2013-01-10T12:36:56-08:00" />
<meta property="dc:type" content="Lab Notebook Entry" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="Lab Notebook" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Is your phylogeny informative?" />
<meta property="og:author" content="http://www.carlboettiger.info/index.html" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2013-01-10T12:36:56-08:00" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://www.carlboettiger.info/2012/01/19/is-your-phylogeny-informative.html" />
<meta property="og:type" content="article" />
<!-- Google Scholar Metadata -->
<meta name="resource_type" content="Lab Notebook"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
<meta name="citation_publication_date" content="10 Jan 2013"/>
<meta name="citation_date" content="10 Jan 2013"/>
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_title" content="Is your phylogeny informative?"/>

    <!-- CSS Stylesheets (toggled with javascript) -->
    <link href="/assets/css/light.css" rel="stylesheet"
          type="text/css" id="stl" title="light" />
    <link href="/assets/css/dark.css" rel="alternate stylesheet" 
          type="text/css" title="dark" />
    <!-- Javascript needed for theme toggle, load immediately -->
    <script type="text/javascript" src="/assets/js/switch-css.js"></script>
    <script type="text/javascript">
      set_style_from_cookie(); 
    </script>
  </head>
  <body> 
  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html"><i style="float:right;" class="icon-info-sign" alt="info" rel="tooltip" title="Credits and technical information about this site" data-placement="bottom"></i></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/vita.html">Vita</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/teaching.html">Teaching</a></li>

          <li>
          <a href="/community.html">Community</a></li>

          <li>
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>
      </div><!--/.nav-collapse -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <p>
         <input type="hidden" name="q" value="site:carlboettiger.info" />
         <input type="text" class="search-query" name="q" />
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
         </p>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->



  <div class="container"> 
    <article> <!-- includes header and entry, but not footer -->
    <header class="jumbotron subhead">
      <h1 class="entry-title">Is your phylogeny informative?</h1>
      <p></p>
    </header>


      <div class="row">
        <div class="span7 offset1">
          <p>Yesterday my paper (Boettiger <em>et. al.</em> 2012)  appeared in early view in Evolution (<a href="http://www.mendeley.com/download/public/98752/4485545655/9a209c7dd29980fd2e47c06eb8b2d1d7dd6f70d4/dl.pdf">author’s preprint</a>),As the open access copy doesn’t appear on pubmed for a while, you can access my author’s copy <a href="http://www.mendeley.com/download/public/98752/4485545655/9a209c7dd29980fd2e47c06eb8b2d1d7dd6f70d4/dl.pdf">here</a>. so I’d like to take this chance to share the back-story and highlight my own view on some of our findings, and the associated <a href="http://cran.r-project.org/web/packages/pmc/index.html">package on CRAN</a>.Just submitted, meanwhile, the code is always on <a href="https://github.com/cboettig/pmc">github</a>.</p>
<p>I didn’t set out to write this paper.  I set out to write a very different paper, introducing a new phylogenetic method for continuous traits that estimates changes in evolutionary constraint.  This adds _even more _parameters than already present in rich models multi-peak OU process, and I wanted to know if it could be justified – if there really was enough information to play the game we already had, before I went and made the situation even worse. Trying to find something rigorous enough to hang my hat on, I ended up writing this paper.</p>
<h3 id="the-short-of-it">The short of it</h3>
<p>There’s essentially three conclusions I draw from the paper.</p>
<ol style="list-style-type: decimal">
<li><p>AIC is not a reliable way to select models.</p></li>
<li><p>Certain parameters, such as \(\lambda\), a measure of “phylogenetic signal,” (Pagel, 1999) are going to be really hard to estimate.</p></li>
<li><p>BUT as long as we <em>simulate extensively</em> to test model choice and parameter uncertainty, we won’t be misled by either of these.  So it’s okay to drink the koolaid (Losos, 2011), but <strong>drink responsibly.</strong></p></li>
</ol>
<h3 id="a-few-reflections">A few reflections</h3>
<p>I really have two problems with AIC and other information criteria when it comes to phylogenetic methods.  One is that it’s too easy to simulate data from one model, and have the information criteria choose a ridiculously over-parameterized model instead.  In one example, the wrong model has a \(\Delta\)AIC of 10 points over the correct model.</p>
<p>But a more basic problem is that it’s just not designed for hypothesis testing – it doesn’t care how much data you have, it doesn’t give a notion of significance.  If we’re ascribing biological meaning to different models as different hypotheses, we need want a measure of uncertainty.</p>
<p>When estimating parameters that scale branch length, I think we must be cautious because these are really data-hungry, and don’t work well on small trees. Check out how few of these estimates of lambda on 100 replicate datasets hit near the correct value shown by vertical line:</p>
<div class="figure">
<img src="http://farm8.staticflickr.com/7014/6727029515_bcfe58aedb_o.png" /><p class="caption"></p>
</div>
<p>The package commands are explained in more detail in the <strong><a href="http://cran.r-project.org/web/packages/pmc/vignettes/pmc_tutorial.pdf">package vignette</a></strong>, but the idea is simple. Running the pmc comparison between two models (for the model-choice step) looks like this:</p>
<pre class="sourceCode R"><code class="sourceCode r">
bm_v_lambda &lt;- <span class="kw">pmc</span>(geospiza.tree, geospiza.data[<span class="st">&quot;wingL&quot;</span>],
  <span class="st">&quot;BM&quot;</span>, <span class="st">&quot;lambda&quot;</span>, <span class="dt">nboot=</span><span class="dv">100</span>)</code></pre>
<p>Extracting the distribution of estimates for the parameter lambda got from fitting the lambda model (B) to data made by simulating under lambda model (A):</p>
<pre class="sourceCode R"><code class="sourceCode r">
lambdas &lt;- <span class="kw">subset</span>(bm_v_lambda[<span class="st">&quot;par_dists&quot;</span>],
  comparison==<span class="st">&quot;BB&quot;</span> &amp; parameter==<span class="st">&quot;lambda&quot;</span>)</code></pre>
<p>To view the model comparison, just plot the pmc result:</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">plot</span>(bm_v_lambda)</code></pre>
<p>The substantial overlap in the likelihood ratios after simulating under either model indicate that we cannot choose between BM and lambda in this case.  I’ll leave the paper to explain this approach in more detail, but it’s just simulation and refitting.</p>
<div class="figure">
<img src="http://farm8.staticflickr.com/7026/6727293465_4a2a545fdf_o.png" /><p class="caption"></p>
</div>
<p>You could just bootstrap the likelihoods or for nested models, look at the parameter distributions, but you get the maximum <em>statistical power</em> from the ratio (says Neyman-Pearson Lemma).</p>
<h3 id="a-technical-note-mix-and-match-formats">A technical note: mix and match formats</h3>
<p>Many users don’t like going between ouch format and ape/phylo formats. The pmc package doesn’t care what you use, feel free to mix and match. In case the conversion tools are useful, I’ve provided functions to move your data and trees back and forth between those formats too.  See <em>format_data()</em> to data-frames and <em>convert()</em> to toggle between tree formats.</p>
<h2 id="reproducible-research">Reproducible Research</h2>
<p>The package is designed to make things easier.  It comes with a vignette (written in sweave) showing just what commands to run to replicate the results from the manuscript.</p>
<p>This entire project has been documented in my open lab notebook from its <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/02/07">inception</a>. Posts prior to October 2010 can be found on my <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010">OWW notebook</a>, the rest in my current <a href="http://www.carlboettiger.info/archives/category/phylogenetics">phylogenetics notebook</a> (here on wordpress). Of course this project is interwoven with many notes on related and more recent work.</p>
<h2 id="additional-methods-and-feedback">Additional methods and feedback</h2>
<p>As we discuss in the paper, simulation and randomization-based methods have an established history in this field(Freckleton &amp; Harvey, 2006), (Harmon <em>et. al.</em> 2010). These are promising things to do, and we should do them more often, but I might make a few comments on these approaches.</p>
<p>We are not getting a real power test when we simulate data produced from different models whose parameters have been arbitrarily assigned, rather than estimated on the same data, lest we overestimate the power. Of course we need to have a likelihood function to be able to estimate those parameters, which is not always available.</p>
<p>It is also common and very useful to assign some summary statistic whose value is expected to be very different under different models of evolution, and look at it’s distribution under simulation. This is certainly valid and has ties to cutting edge approaches in ABC methods, but will be less statistically powerful than if we can calculate the likelihoods of the models directly and compare those, as we do here.</p>
<h6 id="section"></h6>
<p>Boettiger, C., Coop, G., &amp; Ralph, P. (2012). IS YOUR PHYLOGENY INFORMATIVE? MEASURING THE POWER OF COMPARATIVE METHODS Evolution DOI: <a href="http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x">10.1111/j.1558-5646.2012.01574.x</a> ## References</p>
<p>
Boettiger C, Coop G and Ralph P (2012). “is Your Phylogeny Informative? Measuring The Power of Comparative Methods.” <EM>Evolution</EM>. <a href="http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x">http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x</a>.
<p>
Pagel M (1999). “Unknown.” <EM>Nature</EM>, <B>401</B>. ISSN 00280836, <a href="http://dx.doi.org/10.1038/44766">http://dx.doi.org/10.1038/44766</a>.
<p>
Losos J (2011). “Seeing The Forest For The Trees: The Limitations of Phylogenies in Comparative Biology.” <EM>The American Naturalist</EM>, <B>177</B>. ISSN 00030147, <a href="http://dx.doi.org/10.1086/660020">http://dx.doi.org/10.1086/660020</a>.
<p>
Freckleton R and Harvey P (2006). “Detecting Non-Brownian Trait Evolution in Adaptive Radiations.” <EM>Plos Biology</EM>, <B>4</B>. ISSN 1544-9173, <a href="http://dx.doi.org/10.1371/journal.pbio.0040373">http://dx.doi.org/10.1371/journal.pbio.0040373</a>.
<p>
<p>Harmon L, Losos J, Jonathan Davies T, Gillespie R, Gittleman J, Bryan Jennings W, Kozak K, McPeek M, Moreno-Roark F, Near T, Purvis A, Ricklefs R, Schluter D, Schulte II J, Seehausen O, Sidlauskas B, Torres-Carvajal O, Weir J and Mooers A (2010). “Early Bursts of Body Size And Shape Evolution Are Rare in Comparative Data.” <EM>Evolution</EM>. <a href="http://dx.doi.org/10.1111/j.1558-5646.2010.01025.x">http://dx.doi.org/10.1111/j.1558-5646.2010.01025.x</a>.</p>
        </div>


        <!-- Custom sidebar -->      
        <div class="span4">
          <div class="sidebar">
            <aside prefix="dc: http://purl.org/dc/terms/ og:http://ogp.me/ns/article#">
<i class="icon-calendar"></i>
<time datetime="2012-01-19T06:10:49-08:00" 
      property="dc:created">19 Jan 2012</time>.
<br />
          
            <p><a class="btn btn-mini" rel="prev" href='/2012/01/18/wednesday-meetings.html'><i class="icon-chevron-left"></i> prev</a>
          
          
          <a class="btn btn-mini" rel="next" href='/2012/01/20/friday-lab-group-meeting-notes.html'>next <i class="icon-chevron-right"></i></a></p>
          


<br />


<p> <a class="btn btn-mini" href="https://github.com/cboettig/labnotebook/commits/master/_posts/2012-01-19-is-your-phylogeny-informative.md"><i class="icon-time"></i> history</a></p>
<br />
Posted in 
  <a rel="tag" class="category" href="/categories.html#evolution"><span property="dc:subject og:section">evolution</span></a>
  



<br />
tags: 
  <a rel="tag" class="tag" href="/tags.html#my-publications">#<span property="og:tag http://schema.org/BlogPosting/keywords">my-publications</span></a>
  , 

  <a rel="tag" class="tag" href="/tags.html#R">#<span property="og:tag http://schema.org/BlogPosting/keywords">R</span></a>
  , 

  <a rel="tag" class="tag" href="/tags.html#research-blogging">#<span property="og:tag http://schema.org/BlogPosting/keywords">research-blogging</span></a>
  



</aside>

         </div>
       </div>

      </div>
      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="span8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>



</article>
<footer class="footer">
  <form style="font-size:10px">
    <div class="pull-right">
      <span rel="tooltip" title="switch to dark theme">
        <a onclick="switch_style('dark'); return false;" name="theme" value="dark" id="dark" class="btn btn-mini"><i class="icon-adjust"></i></a> 
      </span>
      <span rel="tooltip" title="switch to light theme">
        <a onclick="switch_style('light');return false;" name="theme" value="light" id="light" class="btn btn-mini"><i class="icon-certificate"></i></a> 
      </span>
    </div>
  </form>
          <div class="row">
            <div class="span4 socialicons" style="font-size:20px" vocab="http://xmlns.com/foaf/0.1/" typeof="Person" resource="#me">
              <span rel="tooltip" title="email me">
                <a property="account" href="mailto:cboettig@gmail.com" onclick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><i class="icon-envelope-alt"></i></a>
              </span>
              <span rel="tooltip" title="follow me on twitter (reading, discussing)">
                <a property="account" href="https://twitter.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); return false;"><i class="icon-twitter"></i></a> 
              </span>
              <!--              <a property="account" href="https://plus.google.com/" onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); return false;"><i class="icon-google-plus"></i></a> -->
              <span rel="tooltip" title="follow me on Github (code, research)">
                <a property="account" href="https://github.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><i class="icon-github" alt="github"></i></a> 
              </span>  
              <!--              <a property="account" href="http://www.mendeley.com/profiles/carl-boettiger" onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); return false;"><img src="/assets/img/icon-mendeley.png" alt="mendeley" /></a>  -->
              <span rel="tooltip" title="subscribe to RSS feeds for my open lab notebook">
                <a href="/atom.xml" onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><i class="icon-rss" ></i></a>
              </span>
            </div>
            <div class="span2" style="text-align:center">
              <span rel="tooltip" 
                    title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"><a rel="license" href="http://onsclaims.wikispaces.com/" 
                onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" 
                ><img src="http://onsclaims.wikispaces.com/file/view/ons-aci2-icon.png" alt="ONS" /></a>
            </span>
            </div>
            <div class="span4">
              <a property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="http://i.creativecommons.org/l/zero/1.0/88x31.png" alt="CC0" style="float:right" /></a> 
            </div>
        </div>
      </footer>
    </div><!-- /container -->
    
        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script type="text/javascript" src="http://www.carlboettiger.info/assets/js/jquery.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-transition.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-alert.js"></script>

    <script type="text/javascript">
      $(document).ready(function (){
        $("[rel=tooltip]").tooltip();
      });
    </script>

    <!-- Unused Twitter Bootstrap Javascript 
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-modal.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tab.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-popover.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-button.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-carousel.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/application.js"></script>
    -->


      <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>


        
<!-- Start Open Web Analytics Tracker -->
<script type="text/javascript">
//<![CDATA[
var owa_baseUrl = 'http://www.carlboettiger.info/openwebanalytics/';
var owa_cmds = owa_cmds || [];
owa_cmds.push(['setSiteId', '2886faa411a4139a6c6f97b5a1f38697']);
owa_cmds.push(['trackPageView']);
owa_cmds.push(['trackClicks']);
owa_cmds.push(['trackDomStream']);

(function() {
  var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
  owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
  _owa.src = owa_baseUrl + 'modules/base/js/owa.tracker-combined-min.js';
  var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
}());
//]]>
</script>
<!-- End Open Web Analytics Code -->
        

  </body>
</html>

