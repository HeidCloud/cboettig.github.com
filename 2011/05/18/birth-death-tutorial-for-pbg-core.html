<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8" /> 
    <title>Birth-death Tutorial for PBG Core</title>
    <meta name="author" content="Carl Boettiger" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

  


<!-- HTML5 metadata -->
<meta name="keywords" content="Science, Ecology, Evolution, Open Science, Reproducible Research" />
<meta name="description" content="My open lab notebook- research in theoretical ecology and evolution" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Birth-death Tutorial for PBG Core" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2013-01-10T12:36:56-08:00" />
<meta property="dc:type" content="Lab Notebook Entry" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="Lab Notebook" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Birth-death Tutorial for PBG Core" />
<meta property="og:author" content="http://www.carlboettiger.info/index.html" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2013-01-10T12:36:56-08:00" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://www.carlboettiger.info/2011/05/18/birth-death-tutorial-for-pbg-core.html" />
<meta property="og:type" content="article" />
<!-- Google Scholar Metadata -->
<meta name="resource_type" content="Lab Notebook"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
<meta name="citation_publication_date" content="10 Jan 2013"/>
<meta name="citation_date" content="10 Jan 2013"/>
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_title" content="Birth-death Tutorial for PBG Core"/>

    <!-- CSS Stylesheets (toggled with javascript) -->
    <link href="/assets/css/light.css" rel="stylesheet"
          type="text/css" id="stl" title="light" />
    <link href="/assets/css/dark.css" rel="alternate stylesheet" 
          type="text/css" title="dark" />
    <!-- Javascript needed for theme toggle, load immediately -->
    <script type="text/javascript" src="/assets/js/switch-css.js"></script>
    <script type="text/javascript">
      set_style_from_cookie(); 
    </script>
  </head>
  <body> 
  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html"><i style="float:right;" class="icon-info-sign" alt="info" rel="tooltip" title="Credits and technical information about this site" data-placement="bottom"></i></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/vita.html">Vita</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/teaching.html">Teaching</a></li>

          <li>
          <a href="/community.html">Community</a></li>

          <li>
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>
      </div><!--/.nav-collapse -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <p>
         <input type="hidden" name="q" value="site:carlboettiger.info" />
         <input type="text" class="search-query" name="q" />
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
         </p>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->



  <div class="container"> 
    <article> <!-- includes header and entry, but not footer -->
    <header class="jumbotron subhead">
      <h1 class="entry-title">Birth-death Tutorial for PBG Core</h1>
      <p></p>
    </header>


      <div class="row">
        <div class="span7 offset1">
          <p>Ran a introductory tutorial on birth-death models for phylogenetic trees in R today for Peter Wainwright’s section of the Pop Bio Core sequence. Notes below, in a manner that may suggest I was better organized than reality might attest. Luckily the firsties are brilliant…</p>
<h2 id="getting-started">Getting Started</h2>
<p>Code is shown section by section with results in the following examples.  If you prefer, you can download my full <a href="https://github.com/cboettig/Comparative-Phylogenetics/blob/51ba0cbd07171de5c257b46c677b5c6fa8f61faa/ucd_core/branching_models.R">code file here</a>, but you will have to comment out my flickr plotting utilities before it will run.  Here we go:</p>
<p>Install and load the packages “TreeSim” and “laser”.  Will require a recent version of R for TreeSim to install correctly. We also write two simple custom functions to make our life easier, one to get the age of a tree, one to solve r= b-d and a= b/d for b and d.</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;TreeSim&quot;</span>, <span class="st">&quot;laser&quot;</span>))
<span class="kw">require</span>(TreeSim); <span class="kw">require</span>(laser)

## tree age
treeage &lt;- function(tree){
  if(<span class="kw">is</span>(tree, <span class="st">&quot;phylo&quot;</span>)){
    tree &lt;- <span class="kw">ape2ouch</span>(tree, <span class="dt">scale=</span><span class="ot">FALSE</span>)
    time &lt;- <span class="kw">max</span>(tree@times)
  } else {
    time &lt;- <span class="dv">0</span>
  }
  time
}

<span class="co"># r is diversification rate, b-d, and a is d/b</span>
<span class="co"># we&#39;d rather have in terms of b and d</span>
swp &lt;- function(r, a){
  b = r/(<span class="dv">1</span>-a)
  d = r*a/(<span class="dv">1</span>-a)
  <span class="kw">c</span>(b,d)
}</code></pre>
<h2 id="simulating-birth-death-trees">Simulating Birth-Death Trees</h2>
<p>We’ll start with the TreeSim function sim.bd.age to create birth-death trees.  These examples illustrate the diversity of possible outcomes that result from the <em>identical model</em>.  They also highlight subtleties in defining a model – such as, “was that the age from the origin, or the mrca?”  Our first tree: ((yeah, so this tutorial isn’t that introductory – check the help file on sim.bd.age if you’ve forgotten what the arguments to the function are. We assume knowledge of R b.c. students have used it all year now.))</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">set.seed</span>(<span class="dv">0</span>) <span class="co"># so we all get the same result</span>
tree &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">2</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span><span class="dv">0</span>,<span class="dt">comp=</span>F, <span class="dt">mrca=</span>F)
<span class="kw">print</span>( <span class="kw">treeage</span>(tree[[<span class="dv">1</span>]])  )</code></pre>
<p>We get age=1.907982. Less than the age 2 we asked for, as Tomomi had pointed out. This means the founder species took about 0.1 time steps before the first speciation event. We expect the waiting times to be exponentially distributed. This is easy to confirm:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">set.seed</span>(<span class="dv">0</span>) <span class="co"># so we all get the same result</span>
  trees &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">2</span>,<span class="dt">num=</span><span class="dv">100</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dt">comp=</span>F, <span class="dt">mrca=</span>F)
  times &lt;- <span class="kw">sapply</span>(trees, function(tr){
    <span class="dv">2</span> - <span class="kw">treeage</span>(tr)
  })
  times &lt;- times[times!=<span class="dv">2</span>] <span class="co"># trees that never branch don&#39;t contribute</span>
## Plot Results
<span class="kw">hist</span>(times, <span class="dt">freq=</span>F)
<span class="kw">curve</span>(<span class="kw">dexp</span>(x, <span class="dv">2</span>), <span class="dt">add=</span>T) <span class="co"># theory</span></code></pre>
<div class="figure">
<img src="http://farm3.staticflickr.com/2577/5736177996_9c94cb2561_o.png" /><p class="caption"></p>
</div>
<p>As we mentioned, setting the age equal to the most recent common ancestor (mrca) means the tree does have the age specified. We wondered if this held true when the tree had extinction, since it is possible the first branching event could end up with no descendants on one branch. In that case it isn’t the mrca of extant taxa, and it gets pruned, such that the total length of the tree is still the age given. ((So if we show the complete tree (complete=TRUE) with extinct taxa, is such a taxon floating or lost?)) This example tests this a bunch of times:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  ## This tree is exactly the age we asked for:
  tree &lt;- <span class="kw">sim.bd.age</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dt">complete=</span>F, <span class="dt">mrca=</span>T)
  <span class="kw">print</span>(  <span class="kw">treeage</span>( tree[[<span class="dv">1</span>]] )  )

  ## This tree isn&#39;t always the age we asked for, or is it:
  trees &lt;- <span class="kw">sim.bd.age</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">5</span>,<span class="fl">4.9</span>,<span class="dt">comp=</span>T, <span class="dt">mrca=</span>T)
  <span class="kw">print</span>(  <span class="kw">sapply</span>(trees, function(tr) <span class="kw">treeage</span>(tr))   )</code></pre>
<p>Okay, onto visualizing differences in simulation outcomes. The most obvious is the variety in tip counts, as seen in this 6 taxon example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  trees &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">2</span>,<span class="dt">numbsim=</span><span class="dv">6</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span>.<span class="dv">5</span>,<span class="dt">mrca=</span><span class="ot">TRUE</span>,<span class="dt">complete=</span><span class="ot">FALSE</span>)
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))
  for(i in <span class="dv">1</span>:<span class="dv">6</span>)
    <span class="kw">plot</span>(trees[[i]])
 </code></pre>
<div class="figure">
<img src="http://farm6.staticflickr.com/5185/5735651931_350bb0bc1b_o.png" /><p class="caption"></p>
</div>
<p>Do trees that branch early tend to be the ones with more species?</p>
<p>Notice these trees tend to have many more species than if we were to have mrca=FALSE, because they are older. Conditioning on MRCA age also means that we don’t see empty trees, like we do when we specify age since origin:</p>
<div class="figure">
<img src="http://farm3.staticflickr.com/2758/5734461229_bd856c083d_o.png" /><p class="caption"></p>
</div>
<p>Recall we expect: \[ e^{\lambda t} \approx 54 \] tips on average., and in the case of MRCA=true:</p>
<pre><code>
   tips &lt;- sapply(trees,
                  function(x){
                    if(!is(x, &quot;phylo&quot;))
                      ans &lt;- 0  ## If the object isn&#39;t a tree, it&#39;s `cause all extinct
                   else
                     ans &lt;- x$Nnode+1 ## num tip taxa = 1+internal nodes                    ans}) &gt; ## R OUTPUT
&gt; tips
[1] 49 53 70 40 71 64
&gt; exp(4) ## expectation
[1] 54.59815
&gt; mean(tips)  ## observed over 6 replicates
[1] 57.83333
</code></pre>
<p>Running more replicates we can see the long tail of the Poisson. <img src="http://farm3.staticflickr.com/2513/5735206162_73753568d8_o.png" /></p>
<h3 id="conditioning-on-number-of-taxa">Conditioning on number of taxa</h3>
<p>Often we are not interested in all possible trees (X), but only the subset that have the observed number (N) of taxa.  This results from conditioning on N:</p>
<p>\[ P(X) = P(X|N)P(N) \]</p>
<p>Generating our trees with this command instead accomplishes that.  For a great discussion of these issues see the TreeSim paper (Stadler, 2011)</p>
<pre class="sourceCode r"><code class="sourceCode r">
trees&lt;-  <span class="kw">sim.bd.taxa</span>(<span class="dt">n=</span><span class="dv">20</span>,<span class="dt">numbsim=</span><span class="dv">6</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span>.<span class="dv">5</span>,<span class="dt">complete=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]]</code></pre>
<div class="figure">
<img src="http://farm3.staticflickr.com/2794/5736723143_fe543c61b1_o.png" /><p class="caption"></p>
</div>
<h2>
Fitting Models
</h2>


<pre class="sourceCode r"><code class="sourceCode r">
### Let&#39;s take a closer look at estimating parameters from trees now.   ###
## Start with a simple tree
  tree &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">2</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span><span class="fl">0.0</span>, <span class="dt">mrca=</span><span class="ot">FALSE</span>,<span class="dt">complete=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]]
<span class="co"># fit a birth death model</span>
<span class="co"># gives confidence levels that assume normality</span>
  <span class="kw">birthdeath</span>(tree)
## laser&#39;s way of estimating a model
  model &lt;- <span class="kw">bd</span>(<span class="kw">branching.times</span>(tree))
## estimate a yule model
  yule &lt;- <span class="kw">pureBirth</span>(<span class="kw">branching.times</span>(tree))
<span class="co"># which one is better</span>
  model$aic - yule$aic</code></pre>
<h3 id="bootstrapping-models">Bootstrapping Models</h3>
<pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># simulate a tree, fit a birth-death model, pull out the b and d parameters</span>
  tree &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">4</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span><span class="fl">0.9</span>,
                      <span class="dt">mrca=</span><span class="ot">FALSE</span>,<span class="dt">complete=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]]
  fit &lt;- <span class="kw">bd</span>(<span class="kw">branching.times</span>(tree))
  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
<span class="co"># simulate lots of trees</span>
  boots &lt;- <span class="kw">sim.bd.age</span>(<span class="dt">age=</span><span class="dv">2</span>, <span class="dt">numbsim=</span><span class="dv">500</span>, <span class="dt">lambda=</span>para[<span class="dv">1</span>], <span class="dt">mu=</span>para[<span class="dv">2</span>],
                      <span class="dt">mrca=</span><span class="ot">FALSE</span>, <span class="dt">comp=</span><span class="ot">FALSE</span>)
  bd_dist &lt;- <span class="kw">sapply</span>(boots,
              function(x){
                fit &lt;- <span class="kw">try</span>(<span class="kw">bd</span>(<span class="kw">branching.times</span>(x)))
  ## Some fits fail because bd sucks too.  tell R to tough it out anyhow
                if(!<span class="kw">is</span>(fit, <span class="st">&quot;try-error&quot;</span>))
                  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
                else
                  para &lt;- <span class="ot">NA</span>
                <span class="kw">c</span>(para[<span class="dv">1</span>], para[<span class="dv">2</span>])
              })
  ## err, fix formatting if sapply failed to give me a matrix!
  if(<span class="kw">is</span>(bd_dist, <span class="st">&quot;list&quot;</span>))
    bd_dist &lt;- <span class="kw">sapply</span>(<span class="dv">1</span>:<span class="kw">length</span>(bd_dist),
      function(i) <span class="kw">c</span>(bd_dist[[i]][<span class="dv">1</span>],bd_dist[[i]][<span class="dv">2</span>]))
  bd_dist &lt;- <span class="kw">t</span>(bd_dist)</code></pre>
<div class="figure">
<img src="http://farm4.staticflickr.com/3218/5736235990_81f961bf72_o.png" /><p class="caption"></p>
</div>
<p>This didn’t condition on reality of N species being observed. We can repeat with sim.bd.taxa</p>
<pre class="sourceCode r"><code class="sourceCode r">
  tree &lt;- <span class="kw">sim.bd.taxa</span>(<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span><span class="fl">0.9</span>,
                      <span class="dt">complete=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]
  fit &lt;- <span class="kw">bd</span>(<span class="kw">branching.times</span>(tree))
  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
<span class="co"># simulate lots of trees</span>
  boots &lt;- <span class="kw">sim.bd.taxa</span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">numbsim=</span><span class="dv">500</span>, <span class="dt">lambda=</span>para[<span class="dv">1</span>], <span class="dt">mu=</span>para[<span class="dv">2</span>],
                      <span class="dt">comp=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]]
  bd_dist &lt;- <span class="kw">sapply</span>(boots,
              function(x){
                fit &lt;- <span class="kw">try</span>(<span class="kw">bd</span>(<span class="kw">branching.times</span>(x)))
  ## Some fits fail because bd sucks too.  tell R to tough it out anyhow
                if(!<span class="kw">is</span>(fit, <span class="st">&quot;try-error&quot;</span>))
                  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
                else
                  para &lt;- <span class="ot">NA</span>
                <span class="kw">c</span>(para[<span class="dv">1</span>], para[<span class="dv">2</span>])
              })</code></pre>
<div class="figure">
<img src="http://farm4.staticflickr.com/3276/5735704383_02c969ccb8_o.png" /><p class="caption"></p>
</div>
<p>How about David’s question on bootstrapping the likelihood?  How about when the birth-death model is inappropriate to the data?  Here we will tranform the tree to create a topology very different than any we’ve seen, where branching starts off rapidly and then seems to stop:</p>
<p>Birth-death trees are quite twiggy, this seems like a rather unlikely tree for a birth-death process. <img src="http://farm6.staticflickr.com/5182/5736268982_d689ba66cb_o.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">
  tree &lt;- <span class="kw">sim.bd.taxa</span>(<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">numbsim=</span><span class="dv">1</span>,<span class="dt">lambda=</span><span class="dv">2</span>,<span class="dt">mu=</span><span class="fl">0.9</span>,
                      <span class="dt">complete=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]

  tree &lt;- <span class="kw">lambdaTree</span>(tree, .<span class="dv">2</span>) ## TRANSFORM THE TREE
  fit &lt;- <span class="kw">bd</span>(<span class="kw">branching.times</span>(tree))
  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
<span class="co"># simulate lots of trees</span>
  boots &lt;- <span class="kw">sim.bd.taxa</span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">numbsim=</span><span class="dv">500</span>, <span class="dt">lambda=</span>para[<span class="dv">1</span>], <span class="dt">mu=</span>para[<span class="dv">2</span>],
                      <span class="dt">comp=</span><span class="ot">FALSE</span>)[[<span class="dv">1</span>]]
  bd_dist &lt;- <span class="kw">sapply</span>(boots,
              function(x){
                fit &lt;- <span class="kw">try</span>(<span class="kw">bd</span>(<span class="kw">branching.times</span>(x)))
  ## Some fits fail because bd sucks too.  tell R to tough it out anyhow
                if(!<span class="kw">is</span>(fit, <span class="st">&quot;try-error&quot;</span>)){
                  para &lt;- <span class="kw">swp</span>(fit$r, fit$a)
                  lh &lt;- fit$LH
                }
                else {
                  para &lt;- <span class="ot">NA</span>
                  lh &lt;- <span class="ot">NA</span>
                }
                <span class="kw">c</span>(para[<span class="dv">1</span>], para[<span class="dv">2</span>], lh)
              })
  bd_dist &lt;- <span class="kw">t</span>(bd_dist)

  ## give us a wee peek at some summary data
  <span class="kw">print</span>(<span class="kw">summary</span>(bd_dist))
  <span class="kw">print</span>(<span class="kw">sd</span>(bd_dist, <span class="dt">na.rm=</span>T))

  <span class="kw">png</span>(<span class="st">&quot;bddist.png&quot;</span>, <span class="dt">width=</span><span class="dv">480</span>*<span class="dv">3</span>)
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
    <span class="kw">hist</span>(bd_dist[,<span class="dv">1</span>], <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">main=</span><span class="st">&quot;b&quot;</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span>fit$r, <span class="dt">lwd=</span><span class="dv">4</span>)
    <span class="kw">hist</span>(bd_dist[,<span class="dv">2</span>], <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">main=</span><span class="st">&quot;d&quot;</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span>fit$a, <span class="dt">lwd=</span><span class="dv">4</span>)
    <span class="kw">hist</span>(bd_dist[,<span class="dv">3</span>], <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">main=</span><span class="st">&quot;lik&quot;</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span>fit$LH, <span class="dt">lwd=</span><span class="dv">4</span>)
  <span class="kw">dev.off</span>()</code></pre>
<div class="figure">
<img src="http://farm3.staticflickr.com/2424/5735722223_e54c61c352_o.png" /><p class="caption"></p>
</div>
<p>However, the bootstrap of likelihood (rightmost histogram) does not register as such a bad fit.  Testing model adequacy requires a richer approach.  The bootstrapping estimates our uncertainty under the assumption that our model is reasonable.</p>
<h2 id="a-footnote-on-strange-behavior-in-treesim">A footnote on strange behavior in TreeSim</h2>
<p>Some computers (my laptop) geiger’s prune.extinct.taxa or Tanja’s option to return a only extant taxa (complete=FALSE) end up dropping all tips always.  This bug (after some effort and help from mailing lists yesterday) is caused by having: Sys.setlocale(locale=“en_US.UTF-8”)  and can be fixed by using Sys.setlocale(locale=“C”)  <a href="http://permalink.gmane.org/gmane.comp.lang.r.phylo/1358">see mailing list threads</a>… ## References</p>
<p>
<p>Stadler T (2011). “Simulating Trees With A Fixed Number of Extant Species.” <EM>Systematic Biology</EM>, <B>60</B>. ISSN 1063-5157, <a href="http://dx.doi.org/10.1093/sysbio/syr029">http://dx.doi.org/10.1093/sysbio/syr029</a>.</p>
        </div>


        <!-- Custom sidebar -->      
        <div class="span4">
          <div class="sidebar">
            <aside prefix="dc: http://purl.org/dc/terms/ og:http://ogp.me/ns/article#">
<i class="icon-calendar"></i>
<time datetime="2011-05-18T16:55:05-07:00" 
      property="dc:created">18 May 2011</time>.
<br />
          
            <p><a class="btn btn-mini" rel="prev" href='/2011/05/17/tuesday-3.html'><i class="icon-chevron-left"></i> prev</a>
          
          
          <a class="btn btn-mini" rel="next" href='/2011/05/19/thursday-5.html'>next <i class="icon-chevron-right"></i></a></p>
          


<br />


<p> <a class="btn btn-mini" href="https://github.com/cboettig/labnotebook/commits/master/_posts/2011-05-18-birth-death-tutorial-for-pbg-core.md"><i class="icon-time"></i> history</a></p>
<br />
Posted in 
  <a rel="tag" class="category" href="/categories.html#evolution"><span property="dc:subject og:section">evolution</span></a>
  , 

  <a rel="tag" class="category" href="/categories.html#teaching"><span property="dc:subject og:section">teaching</span></a>
  



<br />
tags: 


</aside>

         </div>
       </div>

      </div>
      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="span8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>



</article>
<footer class="footer">
  <form style="font-size:10px">
    <div class="pull-right">
      <span rel="tooltip" title="switch to dark theme">
        <a onclick="switch_style('dark'); return false;" name="theme" value="dark" id="dark" class="btn btn-mini"><i class="icon-adjust"></i></a> 
      </span>
      <span rel="tooltip" title="switch to light theme">
        <a onclick="switch_style('light');return false;" name="theme" value="light" id="light" class="btn btn-mini"><i class="icon-certificate"></i></a> 
      </span>
    </div>
  </form>
          <div class="row">
            <div class="span4 socialicons" style="font-size:20px" vocab="http://xmlns.com/foaf/0.1/" typeof="Person" resource="#me">
              <span rel="tooltip" title="email me">
                <a property="account" href="mailto:cboettig@gmail.com" onclick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><i class="icon-envelope-alt"></i></a>
              </span>
              <span rel="tooltip" title="follow me on twitter (reading, discussing)">
                <a property="account" href="https://twitter.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); return false;"><i class="icon-twitter"></i></a> 
              </span>
              <!--              <a property="account" href="https://plus.google.com/" onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); return false;"><i class="icon-google-plus"></i></a> -->
              <span rel="tooltip" title="follow me on Github (code, research)">
                <a property="account" href="https://github.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><i class="icon-github" alt="github"></i></a> 
              </span>  
              <!--              <a property="account" href="http://www.mendeley.com/profiles/carl-boettiger" onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); return false;"><img src="/assets/img/icon-mendeley.png" alt="mendeley" /></a>  -->
              <span rel="tooltip" title="subscribe to RSS feeds for my open lab notebook">
                <a href="/atom.xml" onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><i class="icon-rss" ></i></a>
              </span>
            </div>
            <div class="span2" style="text-align:center">
              <span rel="tooltip" 
                    title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"><a rel="license" href="http://onsclaims.wikispaces.com/" 
                onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" 
                ><img src="http://onsclaims.wikispaces.com/file/view/ons-aci2-icon.png" alt="ONS" /></a>
            </span>
            </div>
            <div class="span4">
              <a property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="http://i.creativecommons.org/l/zero/1.0/88x31.png" alt="CC0" style="float:right" /></a> 
            </div>
        </div>
      </footer>
    </div><!-- /container -->
    
        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script type="text/javascript" src="http://www.carlboettiger.info/assets/js/jquery.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-transition.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-alert.js"></script>

    <script type="text/javascript">
      $(document).ready(function (){
        $("[rel=tooltip]").tooltip();
      });
    </script>

    <!-- Unused Twitter Bootstrap Javascript 
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-modal.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tab.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-popover.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-button.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-carousel.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/application.js"></script>
    -->


      <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>


        
<!-- Start Open Web Analytics Tracker -->
<script type="text/javascript">
//<![CDATA[
var owa_baseUrl = 'http://www.carlboettiger.info/openwebanalytics/';
var owa_cmds = owa_cmds || [];
owa_cmds.push(['setSiteId', '2886faa411a4139a6c6f97b5a1f38697']);
owa_cmds.push(['trackPageView']);
owa_cmds.push(['trackClicks']);
owa_cmds.push(['trackDomStream']);

(function() {
  var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
  owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
  _owa.src = owa_baseUrl + 'modules/base/js/owa.tracker-combined-min.js';
  var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
}());
//]]>
</script>
<!-- End Open Web Analytics Code -->
        

  </body>
</html>

