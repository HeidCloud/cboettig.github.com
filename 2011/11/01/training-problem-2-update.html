<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8" /> 
    <title>Training Problem 2 update</title>
    <meta name="author" content="Carl Boettiger" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

  


<!-- HTML5 metadata -->
<meta name="keywords" content="Science, Ecology, Evolution, Open Science, Reproducible Research" />
<meta name="description" content="My open lab notebook- research in theoretical ecology and evolution" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Training Problem 2 update" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2013-01-10T12:36:56-08:00" />
<meta property="dc:type" content="Lab Notebook Entry" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="Lab Notebook" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Training Problem 2 update" />
<meta property="og:author" content="http://www.carlboettiger.info/index.html" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2013-01-10T12:36:56-08:00" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://www.carlboettiger.info/2011/11/01/training-problem-2-update.html" />
<meta property="og:type" content="article" />
<!-- Google Scholar Metadata -->
<meta name="resource_type" content="Lab Notebook"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
<meta name="citation_publication_date" content="10 Jan 2013"/>
<meta name="citation_date" content="10 Jan 2013"/>
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_title" content="Training Problem 2 update"/>

    <!-- CSS Stylesheets (toggled with javascript) -->
    <link href="/assets/css/light.css" rel="stylesheet"
          type="text/css" id="stl" title="light" />
    <link href="/assets/css/dark.css" rel="alternate stylesheet" 
          type="text/css" title="dark" />
    <!-- Javascript needed for theme toggle, load immediately -->
    <script type="text/javascript" src="/assets/js/switch-css.js"></script>
    <script type="text/javascript">
      set_style_from_cookie(); 
    </script>
  </head>
  <body> 
  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html"><i style="float:right;" class="icon-info-sign" alt="info" rel="tooltip" title="Credits and technical information about this site" data-placement="bottom"></i></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/vita.html">Vita</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/teaching.html">Teaching</a></li>

          <li>
          <a href="/community.html">Community</a></li>

          <li>
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>
      </div><!--/.nav-collapse -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <p>
         <input type="hidden" name="q" value="site:carlboettiger.info" />
         <input type="text" class="search-query" name="q" />
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
         </p>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->



  <div class="container"> 
    <article> <!-- includes header and entry, but not footer -->
    <header class="jumbotron subhead">
      <h1 class="entry-title">Training Problem 2 update</h1>
      <p></p>
    </header>


      <div class="row">
        <div class="span7 offset1">
          <h2 id="problem-statement">Problem Statement</h2>
<p>We consider the stochastic optimal control problem of fisheries harvests under the scenarios involving alternate stable states, with uncertainty about the parameters of harvest. We consider a series of introductory problems to prepare us for the full problem. We begin with classical optimal control approaches (Pontraygin’s principle to transform into an ordinary differential equation boundary-value problem) for continuous time state equations (fish population dynamics) as a reference point. We begin with a one-dimensional state equation. We next consider the discrete-time state equation, which we approach with the Bellman/dynamic programming solution, as a useful starting point for the stochastic control. The continuous-time problem can solved from the Hamilton-Jacobi-Bellman PDE, instead of the BVP. While this is less efficient numerically, it generalizes to the stochastic case most naturally. The stochastic solution for the optimal path still assumes perfect knowledge. We can accommodate uncertainty in the state variables in a Bayesian learning framework.</p>
<p>So far I (Carl) am about half-way through these toy examples which will help set up the training problem.  Once we have a common set of tools and code we have quite a few questions to explore within the uncertainty problem.</p>
<p>(See <a href="http://www.carlboettiger.info/archives/2655">original</a> task description)</p>
<h2 id="introductory-problem-by-pontryagin-minimization">Introductory Problem by Pontryagin minimization</h2>
<p>Optimal control with an allee effect. Continuous time, Pontraygin’s minimum principle for the first-order conditions to establish a boundary value problem.</p>
<ul>
<li><p><a href="http://www.carlboettiger.info/archives/3001">BVP derivation</a></p></li>
<li><p><a href="http://www.carlboettiger.info/archives/3049">Numerical solutions</a> in several cases</p></li>
<li><p><a href="https://github.com/cboettig/pdg_control/">Code</a> for numerics</p></li>
</ul>
<h2 id="discrete-problem-by-bellman-equation-dynamic-programming">Discrete problem by Bellman equation, Dynamic Programming</h2>
<p>Optimal control for the analogous discrete time state equations.  Provides a dynamic programming example solution, introduces the cost-to-go.</p>
<ul>
<li><p>Problem setup <a href="http://www.carlboettiger.info/archives/3076">notes</a>.</p></li>
<li><p>Code</p></li>
</ul>
<h2 id="continuous-problem-by-hamilton-jacobi-bellman-pde">Continuous problem by Hamilton-Jacobi-Bellman PDE</h2>
<p>As in the introductory problem. Discritize $ dt $,   and then by Taylor expansion the recursion of the cost to go becomes the HJB PDE:</p>
<p>\[ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   \right) \]</p>
<p>and the optimal path obeys:</p>
<p>\[ h(x,t) = \arg \min_h \left( U(x,h,t) + \beta \partial_x J(x,t) f(x,h, t) \right) \]</p>
<h2 id="stochastic-problem">Stochastic problem</h2>
<p>State equation is an SDE ((perhaps restricted to \(g(x,h,t) = 1\)? )) \[ dx =f(x(t), h(t), t)dt + g(x(t), h(t), t) dB_t \]</p>
<p>and we minimize the expected cost.</p>
<p>\[ \max_h \left( \phi( \langle x(T) \rangle ) + \left \langle \int_0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle \right)\]</p>
<p>For a Gaussian process we solve the stochastic HJB (from taking expectations over the path gives a deterministic PDE by that name):</p>
<p>\[ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   + \frac{1}{2} \nu(x,h,t) \partial_x^2 J(x,t) \right)  \]</p>
<p>Where $ (x,h,t ) $ is the variance dynamics for the state equation.  This may require a numerical solution for appropriate definitions of the stochastic state model, e.g.</p>
<p>$ d X = X (1-) (  ) - X h + X dB $</p>
<p>Not as bad as it appears perhaps; for instance, <a href="http://en.wikipedia.org/wiki/Merton%27s_portfolio_problem">Merton’s portfolio problem</a> is actually an example of this nature with a closed-form solution. There are efficient numerical solutions for linear-quadratic control versions, perhaps of little use to us.</p>
<h2 id="stochastic-problem-with-uncertainty">Stochastic problem with uncertainty</h2>
<p>(Finite time-horizon). Either the parameters of the cost function or the state equation are unknown, and we update our belief about the parameters according to Bayes rule: \[p_{t+dt} (\alpha | dx, h) \propto p(dx | \alpha, h) p_t(\alpha) \]</p>
<p>We define sufficient statistics for this distribution, and have a control problem with an extra dimension in the state equations. The expected profit is computed over both dimensions: \[ \max_h \left \langle \phi( x(T) ) + \int_0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle_{\theta, x} \]</p>
<h2 id="higher-dimensional-dynamics">Higher dimensional dynamics</h2>
<p>Each of these problems can then be repeated with the proper 3-dimensional parrotfish system:</p>
<p>\[ \frac{dM}{dt} = a MC - \frac{g(P) M}{M+T}+\gamma MT \]</p>
<p>\[ \frac{dC}{dt} = (rT - d-aM)C \]</p>
<p>\[ \frac{dP}{dt} = sP\left( 1-\frac{P}{K(C)}\right) - fP\]</p>
<p>K(C) is from territorial limits, rather than food limits.  (Blackwood <em>et. al.</em> 2010)</p>
<p>Adding habitat quality (Blackwood <em>et. al.</em> 2011). ## References</p>
<p>
Blackwood J, Hastings A and Mumby P (2010). “The Effect of Fishing on Hysteresis in Caribbean Coral Reefs.” <EM>Theoretical Ecology</EM>, <B>5</B>. ISSN 1874-1738, <a href="http://dx.doi.org/10.1007/s12080-010-0102-0">http://dx.doi.org/10.1007/s12080-010-0102-0</a>.
<p>
<p>Blackwood J, Hastings A and Mumby P (2011). “A Model-Based Approach to Determine The Long-Term Effects of Multiple Interacting Stressors on Coral Reefs.” <EM>Ecological Applications</EM>, <B>21</B>. ISSN 1051-0761, <a href="http://dx.doi.org/10.1890/10-2195.1">http://dx.doi.org/10.1890/10-2195.1</a>.</p>
        </div>


        <!-- Custom sidebar -->      
        <div class="span4">
          <div class="sidebar">
            <aside prefix="dc: http://purl.org/dc/terms/ og:http://ogp.me/ns/article#">
<i class="icon-calendar"></i>
<time datetime="2011-11-01T07:20:08-07:00" 
      property="dc:created">01 Nov 2011</time>.
<br />
          
            <p><a class="btn btn-mini" rel="prev" href='/2011/11/01/labrids-parrotfish-method1.html'><i class="icon-chevron-left"></i> prev</a>
          
          
          <a class="btn btn-mini" rel="next" href='/2011/11/01/pdg-control-conference-call.html'>next <i class="icon-chevron-right"></i></a></p>
          


<br />


<p> <a class="btn btn-mini" href="https://github.com/cboettig/labnotebook/commits/master/_posts/2011-11-01-training-problem-2-update.md"><i class="icon-time"></i> history</a></p>
<br />
Posted in 
  <a rel="tag" class="category" href="/categories.html#ecology"><span property="dc:subject og:section">ecology</span></a>
  



<br />
tags: 
  <a rel="tag" class="tag" href="/tags.html#PDG+Control">#<span property="og:tag http://schema.org/BlogPosting/keywords">PDG Control</span></a>
  



</aside>

         </div>
       </div>

      </div>
      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="span8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>



</article>
<footer class="footer">
  <form style="font-size:10px">
    <div class="pull-right">
      <span rel="tooltip" title="switch to dark theme">
        <a onclick="switch_style('dark'); return false;" name="theme" value="dark" id="dark" class="btn btn-mini"><i class="icon-adjust"></i></a> 
      </span>
      <span rel="tooltip" title="switch to light theme">
        <a onclick="switch_style('light');return false;" name="theme" value="light" id="light" class="btn btn-mini"><i class="icon-certificate"></i></a> 
      </span>
    </div>
  </form>
          <div class="row">
            <div class="span4 socialicons" style="font-size:20px" vocab="http://xmlns.com/foaf/0.1/" typeof="Person" resource="#me">
              <span rel="tooltip" title="email me">
                <a property="account" href="mailto:cboettig@gmail.com" onclick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><i class="icon-envelope-alt"></i></a>
              </span>
              <span rel="tooltip" title="follow me on twitter (reading, discussing)">
                <a property="account" href="https://twitter.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); return false;"><i class="icon-twitter"></i></a> 
              </span>
              <!--              <a property="account" href="https://plus.google.com/" onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); return false;"><i class="icon-google-plus"></i></a> -->
              <span rel="tooltip" title="follow me on Github (code, research)">
                <a property="account" href="https://github.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><i class="icon-github" alt="github"></i></a> 
              </span>  
              <!--              <a property="account" href="http://www.mendeley.com/profiles/carl-boettiger" onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); return false;"><img src="/assets/img/icon-mendeley.png" alt="mendeley" /></a>  -->
              <span rel="tooltip" title="subscribe to RSS feeds for my open lab notebook">
                <a href="/atom.xml" onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><i class="icon-rss" ></i></a>
              </span>
            </div>
            <div class="span2" style="text-align:center">
              <span rel="tooltip" 
                    title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"><a rel="license" href="http://onsclaims.wikispaces.com/" 
                onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" 
                ><img src="http://onsclaims.wikispaces.com/file/view/ons-aci2-icon.png" alt="ONS" /></a>
            </span>
            </div>
            <div class="span4">
              <a property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="http://i.creativecommons.org/l/zero/1.0/88x31.png" alt="CC0" style="float:right" /></a> 
            </div>
        </div>
      </footer>
    </div><!-- /container -->
    
        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script type="text/javascript" src="http://www.carlboettiger.info/assets/js/jquery.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-transition.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-alert.js"></script>

    <script type="text/javascript">
      $(document).ready(function (){
        $("[rel=tooltip]").tooltip();
      });
    </script>

    <!-- Unused Twitter Bootstrap Javascript 
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-modal.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tab.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-popover.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-button.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-carousel.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/application.js"></script>
    -->


      <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>


        
<!-- Start Open Web Analytics Tracker -->
<script type="text/javascript">
//<![CDATA[
var owa_baseUrl = 'http://www.carlboettiger.info/openwebanalytics/';
var owa_cmds = owa_cmds || [];
owa_cmds.push(['setSiteId', '2886faa411a4139a6c6f97b5a1f38697']);
owa_cmds.push(['trackPageView']);
owa_cmds.push(['trackClicks']);
owa_cmds.push(['trackDomStream']);

(function() {
  var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
  owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
  _owa.src = owa_baseUrl + 'modules/base/js/owa.tracker-combined-min.js';
  var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
}());
//]]>
</script>
<!-- End Open Web Analytics Code -->
        

  </body>
</html>

