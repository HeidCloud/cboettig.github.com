<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns#">
    <meta charset="utf-8" /> 
    <title>Friday: Notes on Labrids, notes on Transforms and size-corrections</title>
    <meta name="author" content="Carl Boettiger" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

  


<!-- HTML5 metadata -->
<meta name="keywords" content="Science, Ecology, Evolution, Open Science, Reproducible Research" />
<meta name="description" content="My open lab notebook- research in theoretical ecology and evolution" />
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections" />
<meta property="dc:creator" content="Carl Boettiger" />
<meta property="dc:date" content="2013-01-10T12:36:56-08:00" />
<meta property="dc:type" content="Lab Notebook Entry" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="Lab Notebook" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections" />
<meta property="og:author" content="http://www.carlboettiger.info/index.html" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Carl"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Boettiger"/>
<meta property="http://ogp.me/ns/article#published_time" content="2013-01-10T12:36:56-08:00" />
<meta property="og:site_name" content="Lab Notebook" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://www.carlboettiger.info/2011/04/29/friday-notes-on-labrids-notes-on-transforms-and-size-corrections.html" />
<meta property="og:type" content="article" />
<!-- Google Scholar Metadata -->
<meta name="resource_type" content="Lab Notebook"/>
<meta name="citation_journal_title" content="Lab Notebook"/>
<meta name="citation_publication_date" content="10 Jan 2013"/>
<meta name="citation_date" content="10 Jan 2013"/>
<meta name="citation_author" content="Carl Boettiger"/>
<meta name="citation_title" content="Friday: Notes on Labrids, notes on Transforms and size-corrections"/>

    <!-- CSS Stylesheets (toggled with javascript) -->
    <link href="/assets/css/light.css" rel="stylesheet"
          type="text/css" id="stl" title="light" />
    <link href="/assets/css/dark.css" rel="alternate stylesheet" 
          type="text/css" title="dark" />
    <!-- Javascript needed for theme toggle, load immediately -->
    <script type="text/javascript" src="/assets/js/switch-css.js"></script>
    <script type="text/javascript">
      set_style_from_cookie(); 
    </script>
  </head>
  <body> 
  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html"><i style="float:right;" class="icon-info-sign" alt="info" rel="tooltip" title="Credits and technical information about this site" data-placement="bottom"></i></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/vita.html">Vita</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/teaching.html">Teaching</a></li>

          <li>
          <a href="/community.html">Community</a></li>

          <li>
          <a href="/lab-notebook.html">Lab Notebook</a></li>

        </ul>
      </div><!--/.nav-collapse -->
      <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <p>
         <input type="hidden" name="q" value="site:carlboettiger.info" />
         <input type="text" class="search-query" name="q" />
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button> 
         </p>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->



  <div class="container"> 
    <article> <!-- includes header and entry, but not footer -->
    <header class="jumbotron subhead">
      <h1 class="entry-title">Friday: Notes on Labrids, notes on Transforms and size-corrections</h1>
      <p></p>
    </header>


      <div class="row">
        <div class="span7 offset1">
          <p>The specific traits were:</p>
<p>Oral Jaw traits</p>
<ol style="list-style-type: decimal">
<li><p>mouth-closing lever ratio (Close),</p></li>
<li><p>mouth-opening lever ratio (Open), kinematic</p></li>
<li><p>transmission coefficient of the oral jaws four-bar linkage (Jaw KT),</p></li>
<li><p>adductor mandibulae (AM) muscle mass,</p></li>
<li><p>premaxillary protrusion distance (Prot),</p></li>
<li><p>gape width (Gape),</p></li>
</ol>
<p>Exterior to the Oral Jaws, not expected to become unconstrained:</p>
<ul>
<li><p>levator posterior (LP) muscle mass: (Pharyngeal jaw muscle)</p></li>
<li><p>sterno-hyoideus (SH) muscle mass, (Primarily buccual cavity)</p></li>
<li><p>adult body mass (Body mass).</p></li>
</ul>
<p>See (WAINWRIGHT <em>et. al.</em> 2004).</p>
<p>Species: 122 in dataset (34 parrotfish, 88 wrasses)</p>
<p>Species in phylogeny: 34 parrotfish. 80 wrasses.  Hmm, my phylogeny is missing 8 wrasses.</p>
<h2 id="transforms">Transforms</h2>
<p>In (Price <em>et. al.</em> 2010), all linear lengths are log-transformed, masses are log transformed after cube-root transform. Why: An assumption of linear growth with percent, combined with an allometry that makes all linear dimensions increase together (hence mass increases by the cube of any increase in a length). Should evolution really preserve such an allometry? Does the cube root matter, since it’s just a multiplicative scaling constant once we are in log space?</p>
<p>What about the lever ratios? assume they are untransformed? Also uncorrected for mass?</p>
<p>These log-transformed traits are then used to compute contrasts. Contrasts are regressed through the origin against body-mass. This regression is then used to get residuals of the log-traits, and these residuals are modeled as BM or OU, etc.</p>
<p>Size-correction can seem rather challenging.  Of course evolution of different traits (rates of evolution, shifts, etc) are correlated, and as most traits couple strongly to size and size explains a great deal of disparity, lack of size-corrections risk data that appears to be, say, showing shifts in rate of jaw evolution when it instead shows shifts in the rate of body-size evolution.  Hence the need for size correction.</p>
<p>A common though non-ideal method is a linear regression of log-trait values against log-size.  This regression assumes that you have a bunch of measurements of (tooth size, body size) which are independent of each other. Because of the phylogeny, you don’t (the classic Felsenstein 1985 situation). The standard approach leaves you with independent contrasts, not the traits themselves.  Recall that we just want to do the regression correctly, we weren’t ready to remove the effect of phylogeny, since we’re still gearing up to do a comparative method .</p>
<p>Revell takes great care to address this issue, (Revell, 2009) demonstrating how we get corrected values of the traits themselves, rather than being left with contrasts.</p>
<blockquote>
<p>Types of analyses that might require transformed values for tip species include (but are not limited to): the estimation of phylogenetic signal (Freckleton et al. 2002; Blomberg et al. 2003); ancestral state reconstruction (Schluter et al. 1997); the phylogenetic analysis of variance (ANOVA) or analysis of covariance (ANCOVA) (Garland et al. 1993); and phylogenetic regression in which both slope and intercept (or prediction in the species space) are of concern (Rohlf 2001).</p>
</blockquote>
<p>Getting the size-correction using the phylogeny does not mean that we are done with the phylogeny – the size-corrected values trait still have phylogenetic correlations, this just means we did the linear regression correctly in order to size correct in the first place, which as Revell cites, may not be the right way to size correct anyway, see Garcia_Berthou (2001), Freckleton(2002, 2009).</p>
<p>This attempts to correct for body-mass in a phylogenetic manner – under the assumptions:</p>
<ol style="list-style-type: lower-alpha">
<li><p>There is a linear relationship between body mass and other traits $ () ()$</p></li>
<li><p>Though the relationship comes from a functional constraint, samples from a phylogeny aren’t independent – giving us a false representation of power.</p></li>
</ol>
<p>At this stage we aren’t trying to create independent samples of the functional process that connects to traits. We just want to identify what quantity we hypothesize follows our evolutionary model of little steps. We can convincingly argue that it isn’t the length – we think of growth by percent increases – a mutation equally likely to increase or decrease the length by 1%, say, rather than by 1cm. Logs do this for us.</p>
<p>Unfortunately it seems difficult to argue that residuals have this same natural interpretation, particularly when we would like to insist that both the traits and the residuals follow one of the common models (i.e. Brownian motion).</p>
<p>Assume the focal trait <em>X</em> and the body size <em>Y</em> are Brownian, in order to justify the Brownian-based phylogenetic Revell collection.  The residuals  <em>Z</em> are differences between these:</p>
<p>\[ dX_t = \sigma_{X} dB_{1} \] \[ dY_t = \sigma_{Y} dB_{2} \]</p>
<p>The solutions to these are Gaussians, unfortunately the regression \[\beta\] doesn’t result in residuals that are also Gaussians,</p>
<p>\[ Z_t = X_t - \beta Y_t \] \[ Z_t = N(\sigma_X) - \beta N(\sigma_Y) \]</p>
<p>which is not normally distributed (sums of normals aren’t normals).  (Note that this differs from the standard regression in which there is only one source of noise, $ y ~ x + $).  The same is true for any of the common phylogenetic models, which are all multivariate normal distributions.</p>
<p>It seems impossible to do the phylogenetic correction of (Revell, 2009) consistently.  One could instead assert that the ratio of some size to body-size is, say, Brownian, without asserting that the individual traits are Brownian, and have a perhaps more consistent size correction.</p>
<h2 id="references">References</h2>
<p>
WAINWRIGHT P, BELLWOOD D, WESTNEAT M, GRUBICH J and HOEY A (2004). “A Functional Morphospace For The Skull of Labrid Fishes: Patterns of Diversity in A Complex Biomechanical System.” <EM>Biological Journal of The Linnean Society</EM>, <B>82</B>. <a href="http://dx.doi.org/10.1111/j.1095-8312.2004.00313.x">http://dx.doi.org/10.1111/j.1095-8312.2004.00313.x</a>.
<p>
Price S, Wainwright P, Bellwood D, Kazancioglu E, Collar D and Near T (2010). “Functional Innovations And Morphological Diversification in Parrotfish.” <EM>Evolution</EM>. <a href="http://dx.doi.org/10.1111/j.1558-5646.2010.01036.x">http://dx.doi.org/10.1111/j.1558-5646.2010.01036.x</a>.
<p>
<p>Revell L (2009). “Size-Correction And Principal Components For Interspecific Comparative Studies.” <EM>Evolution</EM>, <B>63</B>. ISSN 00143820, <a href="http://dx.doi.org/10.1111/j.1558-5646.2009.00804.x">http://dx.doi.org/10.1111/j.1558-5646.2009.00804.x</a>.</p>
        </div>


        <!-- Custom sidebar -->      
        <div class="span4">
          <div class="sidebar">
            <aside prefix="dc: http://purl.org/dc/terms/ og:http://ogp.me/ns/article#">
<i class="icon-calendar"></i>
<time datetime="2011-04-29T15:19:43-07:00" 
      property="dc:created">29 Apr 2011</time>.
<br />
          
            <p><a class="btn btn-mini" rel="prev" href='/2011/04/28/thursday-reading-notes.html'><i class="icon-chevron-left"></i> prev</a>
          
          
          <a class="btn btn-mini" rel="next" href='/2011/05/03/monday-3.html'>next <i class="icon-chevron-right"></i></a></p>
          


<br />


<p> <a class="btn btn-mini" href="https://github.com/cboettig/labnotebook/commits/master/_posts/2011-04-29-friday-notes-on-labrids-notes-on-transforms-and-size-corrections.md"><i class="icon-time"></i> history</a></p>
<br />
Posted in 
  <a rel="tag" class="category" href="/categories.html#evolution"><span property="dc:subject og:section">evolution</span></a>
  



<br />
tags: 


</aside>

         </div>
       </div>

      </div>
      <!-- Disqus Comments -->
      <div class="row disqus">
        <div class="span8">          
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cboettig'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>



</article>
<footer class="footer">
  <form style="font-size:10px">
    <div class="pull-right">
      <span rel="tooltip" title="switch to dark theme">
        <a onclick="switch_style('dark'); return false;" name="theme" value="dark" id="dark" class="btn btn-mini"><i class="icon-adjust"></i></a> 
      </span>
      <span rel="tooltip" title="switch to light theme">
        <a onclick="switch_style('light');return false;" name="theme" value="light" id="light" class="btn btn-mini"><i class="icon-certificate"></i></a> 
      </span>
    </div>
  </form>
          <div class="row">
            <div class="span4 socialicons" style="font-size:20px" vocab="http://xmlns.com/foaf/0.1/" typeof="Person" resource="#me">
              <span rel="tooltip" title="email me">
                <a property="account" href="mailto:cboettig@gmail.com" onclick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><i class="icon-envelope-alt"></i></a>
              </span>
              <span rel="tooltip" title="follow me on twitter (reading, discussing)">
                <a property="account" href="https://twitter.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); return false;"><i class="icon-twitter"></i></a> 
              </span>
              <!--              <a property="account" href="https://plus.google.com/" onclick="recordOutboundLink(this, 'Outbound Links', 'GPlus'); return false;"><i class="icon-google-plus"></i></a> -->
              <span rel="tooltip" title="follow me on Github (code, research)">
                <a property="account" href="https://github.com/cboettig" onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><i class="icon-github" alt="github"></i></a> 
              </span>  
              <!--              <a property="account" href="http://www.mendeley.com/profiles/carl-boettiger" onclick="recordOutboundLink(this, 'Outbound Links', 'Mendeley'); return false;"><img src="/assets/img/icon-mendeley.png" alt="mendeley" /></a>  -->
              <span rel="tooltip" title="subscribe to RSS feeds for my open lab notebook">
                <a href="/atom.xml" onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><i class="icon-rss" ></i></a>
              </span>
            </div>
            <div class="span2" style="text-align:center">
              <span rel="tooltip" 
                    title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"><a rel="license" href="http://onsclaims.wikispaces.com/" 
                onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" 
                ><img src="http://onsclaims.wikispaces.com/file/view/ons-aci2-icon.png" alt="ONS" /></a>
            </span>
            </div>
            <div class="span4">
              <a property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="http://i.creativecommons.org/l/zero/1.0/88x31.png" alt="CC0" style="float:right" /></a> 
            </div>
        </div>
      </footer>
    </div><!-- /container -->
    
        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script type="text/javascript" src="http://www.carlboettiger.info/assets/js/jquery.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-transition.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-alert.js"></script>

    <script type="text/javascript">
      $(document).ready(function (){
        $("[rel=tooltip]").tooltip();
      });
    </script>

    <!-- Unused Twitter Bootstrap Javascript 
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-modal.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-tab.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-popover.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-button.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-carousel.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://www.carlboettiger.info/assets/js/application.js"></script>
    -->


      <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-18401403-1']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
  </script>



<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-18401403-1");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>


        
<!-- Start Open Web Analytics Tracker -->
<script type="text/javascript">
//<![CDATA[
var owa_baseUrl = 'http://www.carlboettiger.info/openwebanalytics/';
var owa_cmds = owa_cmds || [];
owa_cmds.push(['setSiteId', '2886faa411a4139a6c6f97b5a1f38697']);
owa_cmds.push(['trackPageView']);
owa_cmds.push(['trackClicks']);
owa_cmds.push(['trackDomStream']);

(function() {
  var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
  owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
  _owa.src = owa_baseUrl + 'modules/base/js/owa.tracker-combined-min.js';
  var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
}());
//]]>
</script>
<!-- End Open Web Analytics Code -->
        

  </body>
</html>

